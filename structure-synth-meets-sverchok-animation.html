<!doctype html>
<html lang="">	
<head>
	<meta charset="utf-8"/>
	<title>Structure Synth meets Sverchok - Animation - Look Think Make</title>	
	<meta name="author" content="elfnor">
	

	<meta name="description" content="Update: This lsystem/Structure Synth code has now (March 2016) been incorporated into the Sverchok Generative Art node. See the updated examples and the node docs In the previous two posts (Generative Art in Blender and Mesh Mode I introduced the Sverchok scripted node I'd written to implement Structure ...">


	<link rel="top" href="#" /><link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro' rel='stylesheet' type='text/css'></link>
	<link href='http://fonts.googleapis.com/css?family=Bitter' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Rock+Salt' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://www.elfnor.com/theme/css/main.css" type="text/css" />
		

    <link href="http://www.elfnor.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Look Think Make Atom Feed" />
</head>
	
<body>

    <div class="container">
	  
	  <header role="banner">
	    <div class="feeds">
	        <a href="http://www.elfnor.com/feeds/all.atom.xml" rel="alternate"><img src="/theme/images/icons/feed-32px.png" alt="atom feed"/></a>
	    </div>
	      <nav class="pages">
			  <a href="http://www.elfnor.com/pages/about-me.html">About Me</a>
-			  <a href="http://www.elfnor.com/pages/galleries.html">Galleries</a>
	      </nav>
		<a href="http://www.elfnor.com" class="title">Look Think Make</a>
      </header>
	
	  <div class="wrapper">

		  <div role="main" class="content">
	<article class="full">
			
		<h1>Structure Synth meets Sverchok - Animation</h1>
		
<div class="metadata">
  <time datetime="2015-03-22T22:00:00+13:00" pubdate>Sun 22 March 2015</time>
    <address class="vcard author">
      by <a class="url fn" href="http://www.elfnor.com/author/elfnor.html">elfnor</a>
    </address>
  in <a href="http://www.elfnor.com/category/think.html">think</a>
<p class="tags">tagged <a href="http://www.elfnor.com/tag/make.html">make</a>, <a href="http://www.elfnor.com/tag/think.html">think</a>, <a href="http://www.elfnor.com/tag/blender.html">blender</a>, <a href="http://www.elfnor.com/tag/sverchok.html">sverchok</a>, <a href="http://www.elfnor.com/tag/structuresynth.html">structuresynth</a></p></div>		
		<p><img alt="still from fern  animation" src="./images/fern_anim_still_05.png" /></p>
<p>Update: This lsystem/Structure Synth code has now (March 2016) been incorporated into the Sverchok <em>Generative Art</em> node. See the <a href="http://www.elfnor.com/generative-art-updated-examples.html">updated examples</a> and the <a href="http://www.elfnor.com/generative-art-sverchok-node-update.html">node docs</a></p>
<p>In the previous two posts (<a href="http://www.elfnor.com/structure-synth-meets-sverchok-generative-art-inside-blender.html">Generative Art in Blender</a> and <a href="http://www.elfnor.com/structure-synth-meets-sverchok-mesh-mode.html">Mesh Mode</a> I introduced the <a href="http://nikitron.cc.ua/sverchok_en.html">Sverchok</a> scripted node I'd written to implement <a href="http://structuresynth.sourceforge.net/">Structure Synth</a> generative art or lsystems inside Blender.</p>
<p>Following <a href="">Martinius's suggestion</a> I've now exposed parameters in the xml rule definition to the Sverchok node tree so we can do animation of Structure Synth lsystems inside Blender.</p>
<p>Here's an example:</p>
<iframe src="https://player.vimeo.com/video/123063760?title=0&byline=0&portrait=0" width="500" height="375" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>

<p><p><a href="https://vimeo.com/123063760">Pounamu Fern Animation</a> from <a href="https://vimeo.com/user38620121">elfnor</a> on <a href="https://vimeo.com">Vimeo</a>.</p></p>
<p>As before, to use the generative art node in Blender first install the <a href="http://nikitron.cc.ua/sverchok_en.html">Sverchok</a> addon. Download the lsystem code from <a href="https://github.com/elfnor/lsystem">github</a>. Then load the three python files in the Blender directory (<code>LSystem_blender.py, GA_xml.py, GA_node.py</code>) as separate text blocks into a blend file. Add a "Scripted Node" to a Sverchok node tree. On the node select the <code>GA_node.py</code> code from the lower drop down. Then click the plugin icon to the right of this field. The node should turn blue with some inputs and outputs.</p>
<p>The latest version now has an additional input "variables". </p>
<p>The first step to animating the lsystem is to edit the lsystem definition in the xml text in <code>GA_xml.py</code> to define which values becomes variables. The value for any of the transforms in the file can be replaced with a pair of curly braces:</p>
<div class="highlight"><pre><span></span>transforms = &quot;tx 0.5 rx 20 sa 0.9&quot;
</pre></div>


<p>becomes</p>
<div class="highlight"><pre><span></span>transforms = &quot;tx {} rx 20 sa 0.9&quot;
</pre></div>


<p>To illustrate this here is the xml definition and the node diagram for the fern animation.</p>
<div class="highlight"><pre><span></span>Library[&quot;FernVars&quot;] = &quot;&quot;&quot;
<span class="nt">&lt;rules</span> <span class="na">max_depth=</span><span class="s">&quot;2000&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;call</span>  <span class="na">rule=</span><span class="s">&quot;curl1&quot;</span> <span class="nt">/&gt;</span>  
       <span class="nt">&lt;call</span>  <span class="na">rule=</span><span class="s">&quot;curl2&quot;</span> <span class="nt">/&gt;</span>      
    <span class="nt">&lt;/rule&gt;</span>

    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;curl1&quot;</span> <span class="na">max_depth=</span><span class="s">&quot;60&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;rx {} tz 1.5 s 0.9 0.9 1.0&quot;</span> <span class="na">rule=</span><span class="s">&quot;curl1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;instance</span> <span class="na">shape=</span><span class="s">&quot;box&quot;</span><span class="nt">/&gt;</span>        
    <span class="nt">&lt;/rule&gt;</span>

    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;curl2&quot;</span> <span class="na">max_depth=</span><span class="s">&quot;40&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;rx {} tz 1.5 s 0.9 0.9 1.0&quot;</span> <span class="na">rule=</span><span class="s">&quot;curl2&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;tx 0.1 ty -0.45 ry 40 sa 0.25&quot;</span> <span class="na">rule=</span><span class="s">&quot;curlsmall&quot;</span> <span class="nt">/&gt;</span>     
    <span class="nt">&lt;/rule&gt;</span>    

    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;curlsmall&quot;</span> <span class="na">max_depth=</span><span class="s">&quot;40&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;rx 2*{} tz 2.7 s 0.9 0.9 1.0&quot;</span> <span class="na">rule=</span><span class="s">&quot;curlsmall&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;instance</span> <span class="na">shape=</span><span class="s">&quot;box&quot;</span><span class="nt">/&gt;</span>     
    <span class="nt">&lt;/rule&gt;</span>    
<span class="nt">&lt;/rules&gt;</span>
&quot;&quot;&quot;
</pre></div>


<p><img alt="node diagram for fern animation" src="./images/GA_Fern_animation_03.blend.png" /></p>
<p>For this animation the index number of the current frame in the animation is translated from the range 1 to 250 to the range 16 to 6 via the formula node  and wired into the "variables" input of the "GA_node". This cause the fern to unwind as the animation proceeds. The separate objects are joined into one using the "Mesh Join" node and this output sent to the "Bmesh Viewer Draw" node. </p>
<p>If you want to animate more than one parameter use index numbers (starting with 0) inside the braces:</p>
<div class="highlight"><pre><span></span>transforms = &quot;tx {0} rx {1} sa {2}&quot;
</pre></div>


<p>With multiple parameters a "List Join" node is used to make a list to use as the "variables" input of the "GA_node".</p>
<p><img alt="node diagram with list join" src="./images/GA_node-variables_attributes.blend.png" /></p>
<p>If not enough variables are provided the last one is repeated as many times as required.</p>
<p>Simple maths can also be use in the transforms definition. This has been used above in the "curlsmall" rule. The rx rotation of the transform will always be twice that of the rx rotation in the "curl1" and "curl2" rules.</p>
<p>There cannot be any spaces in any maths expressions for the rotation, translation or scale parameters when using a transforms attribute string as above.  Instead of listing all the transforms in one attribute string each transform can now have its own string. This allows more complicated expressions to be included. </p>
<p>transforms as single attribute (no spaces allowed in maths expression)</p>
<div class="highlight"><pre><span></span>&lt;call transforms=&quot;tx 1 rz -1*{0} ry {1}&quot; rule=&quot;R1&quot;/&gt;
</pre></div>


<p>each transform with its own attribute (can have spaces)</p>
<div class="highlight"><pre><span></span>&lt;call tx=&quot;1&quot; rz=&quot;-1 * {0}&quot; ry=&quot;{1}&quot; rule=&quot;R1&quot;/&gt;
</pre></div>


<p>All this is implemented by first using python's string format method to substitute in the variable value from the node input. Then the resulting string is passed to python's <code>eval()</code> function. The string must evaluate to a single number (float or integer). Using <code>eval()</code> is a potential security problem as in theory someone could put some malicious code inside an xml lsystem definition. As always don't run code from a source you don't trust.</p>
<p>Only the transforms that take a single number that is tx, ty, tz, rx, ry, rz, sx, sy, sz and sa have been implemented using individual attributes. The ones that use triplets to specify all three translations or scales at once (t and s) can only be used in a transform string.</p>
<p>There's room to do some very clever stuff using this ability to put short bits of code in the xml... </p>
<hr />	

	</article>

	<div class="comments">
	<h2>Comments !</h2>
	    <div id="disqus_thread"></div>
	    <script type="text/javascript">
	       var disqus_identifier = "structure-synth-meets-sverchok-animation.html";
	       (function() {
	       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	       dsq.src = 'http://lookthinkmake.disqus.com/embed.js';
	       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	      })();
	    </script>
	</div>

		  </div>	
		  
		  <div class="sidebar">

	        <nav>
		  <h2>Recent Posts</h2>
			<ul class="archive">
	
			      <li>
<a href="http://www.elfnor.com/sugar-free-fermented-marmalade.html" rel="bookmark" title="Permalink to Sugar-Free Fermented Marmalade">Sugar-Free Fermented Marmalade</a>
  <time datetime="2017-01-29T22:00:00+13:00" pubdate>Sun 29 January 2017</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/food.html">food  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/preserved-lemons.html" rel="bookmark" title="Permalink to Preserved Lemons">Preserved Lemons</a>
  <time datetime="2017-01-13T22:00:00+13:00" pubdate>Fri 13 January 2017</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/food.html">food  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/fermented-chili-and-garlic-sauce.html" rel="bookmark" title="Permalink to Fermented Chili and Garlic sauce">Fermented Chili and Garlic sauce</a>
  <time datetime="2017-01-06T22:00:00+13:00" pubdate>Fri 06 January 2017</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/food.html">food  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/pyboard-datalogger.html" rel="bookmark" title="Permalink to PyBoard Datalogger">PyBoard Datalogger</a>
  <time datetime="2016-10-21T22:00:00+13:00" pubdate>Fri 21 October 2016</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/python.html">python  </a><a href="http://www.elfnor.com/tag/micropython.html">micropython  </a><a href="http://www.elfnor.com/tag/3d-printing.html">3D Printing  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/sverchok-tree-generator.html" rel="bookmark" title="Permalink to Sverchok Tree Generator">Sverchok Tree Generator</a>
  <time datetime="2016-08-12T22:00:00+12:00" pubdate>Fri 12 August 2016</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/sverchok.html">sverchok  </a><a href="http://www.elfnor.com/tag/generative-art.html">generative art  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/penrose-tile-painting-in-blender.html" rel="bookmark" title="Permalink to Penrose Tile Painting in Blender">Penrose Tile Painting in Blender</a>
  <time datetime="2016-06-04T22:00:00+12:00" pubdate>Sat 04 June 2016</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/symmetrytile.html">symmetrytile  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/structure-synth-eisenscript-to-xml-translator.html" rel="bookmark" title="Permalink to Structure Synth eisenscript to xml translator">Structure Synth eisenscript to xml translator</a>
  <time datetime="2016-05-29T22:00:00+12:00" pubdate>Sun 29 May 2016</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/sverchok.html">sverchok  </a><a href="http://www.elfnor.com/tag/structure-synth.html">structure synth  </a><a href="http://www.elfnor.com/tag/generative-art.html">generative art  </a></p></a>      			      </li>
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
	
                        </u1>
		
		</nav>

	          <h2>Categories</h2>
	          <ul class = "social">
		      <li> <a href="http://www.elfnor.com/archives.html">everything </a></li>	
	              <li ><a href="http://www.elfnor.com/category/food.html">food</a></li>
	              <li ><a href="http://www.elfnor.com/category/look.html">look</a></li>
	              <li ><a href="http://www.elfnor.com/category/make.html">make</a></li>
	              <li class="active"><a href="http://www.elfnor.com/category/think.html">think</a></li>
	          </ul>
	        

	          <aside>
	          <h2>Elsewhere</h2>
			    <ul class="social">
				  <li><a href="http://elfnor.deviantart.com">on deviant art</a><i></i></li>
				  <li><a href="http://www.thingiverse.com/elfnor">on thingiverse</a><i></i></li>
				  <li><a href="https://github.com/elfnor">on github</a><i></i></li>
			    </ul>
			  </aside>
                
                <h2>Tags</h2>
	
                        <ul class="tagcloud">
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/blender.html">blender</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/pelican.html">pelican</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/food.html">food</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/nonsense.html">nonsense</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/ebook.html">ebook</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/geocaching.html">geocaching</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/micropython.html">micropython</a></li>
                            <li class="tag-2"><a href="http://www.elfnor.com/tag/structuresynth.html">structuresynth</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/python.html">python</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/webalbum.html">webalbum</a></li>
                            <li class="tag-2"><a href="http://www.elfnor.com/tag/symmetrytile.html">symmetrytile</a></li>
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/make.html">make</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/photo.html">photo</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/cats.html">cats</a></li>
                            <li class="tag-2"><a href="http://www.elfnor.com/tag/reading.html">reading</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/kites.html">kites</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/markdown.html">markdown</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/processing.html">processing</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/maze.html">maze</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/3d-printing.html">3D Printing</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/structure-synth.html">structure synth</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/copy2.html">copy2</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/generative-art.html">generative art</a></li>
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/sverchok.html">sverchok</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/astro.html">astro</a></li>
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/think.html">think</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/materials.html">materials</a></li>
                        </ul>
                      
		
		  </div>

	  </div>

      <footer>
		<p role="contentinfo">
		  © 2013 elfnor - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-simplegrey"> pelican-simplegrey</a>, modified.
    	</p>

	  </footer>	

	</div>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=9900594; 
var sc_invisible=1; 
var sc_security="efb2c43c"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="free hit
counter" href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="http://c.statcounter.com/9900594/0/efb2c43c/1/"
alt="free hit counter"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</body>
</html>