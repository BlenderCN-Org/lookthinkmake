<!doctype html>
<html lang="">	
<head>
	<meta charset="utf-8"/>
	<title>Structure Synth meets Sverchok - Mesh mode - Look Think Make</title>	
	<meta name="author" content="elfnor">
	

	<meta name="description" content="In the previous post I introduced the Sverchok scripted node I'd written to implement Structure Synth generative art or lsystems inside Blender. In this post I'll cover a couple of features I've added to the basic node. Mask output An xml rule set for the lsystem can ...">


	<link rel="top" href="#" /><link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro' rel='stylesheet' type='text/css'></link>
	<link href='http://fonts.googleapis.com/css?family=Bitter' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Rock+Salt' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://www.elfnor.com/theme/css/main.css" type="text/css" />
		

    <link href="http://www.elfnor.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Look Think Make Atom Feed" />
</head>
	
<body>

    <div class="container">
	  
	  <header role="banner">
	    <div class="feeds">
	        <a href="http://www.elfnor.com/feeds/all.atom.xml" rel="alternate"><img src="/theme/images/icons/feed-32px.png" alt="atom feed"/></a>
	    </div>
	      <nav class="pages">
			  <a href="http://www.elfnor.com/pages/about-me.html">About Me</a>
-			  <a href="http://www.elfnor.com/pages/galleries.html">Galleries</a>
	      </nav>
		<a href="http://www.elfnor.com" class="title">Look Think Make</a>
      </header>
	
	  <div class="wrapper">

		  <div role="main" class="content">
	<article class="full">
			
		<h1>Structure Synth meets Sverchok - Mesh mode</h1>
		
<div class="metadata">
  <time datetime="2015-03-15T22:00:00+13:00" pubdate>Sun 15 March 2015</time>
    <address class="vcard author">
      by <a class="url fn" href="http://www.elfnor.com/author/elfnor.html">elfnor</a>
    </address>
  in <a href="http://www.elfnor.com/category/think.html">think</a>
<p class="tags">tagged <a href="http://www.elfnor.com/tag/make.html">make</a>, <a href="http://www.elfnor.com/tag/think.html">think</a>, <a href="http://www.elfnor.com/tag/blender.html">blender</a>, <a href="http://www.elfnor.com/tag/sverchok.html">sverchok</a>, <a href="http://www.elfnor.com/tag/structuresynth.html">structuresynth</a></p></div>		
		<p><img alt="pounamu fern" src="/images/fern_30.png" /></p>
<p>In the previous <a href="http://www.elfnor.com/structure-synth-meets-sverchok-generative-art-inside-blender.html">post</a> I introduced the <a href="http://nikitron.cc.ua/sverchok_en.html">Sverchok</a> scripted node I'd written to implement <a href="http://structuresynth.sourceforge.net/">Structure Synth</a> generative art or lsystems inside Blender.</p>
<p>In this post I'll cover a couple of features I've added to the basic node.</p>
<h2>Mask output</h2>
<p>An xml rule set for the lsystem can have different objects in different instances. In the xml below there are two versions of the "R1" rule. These will be called randomly. The two different rules have opposite signs for the "ry" transform. This will cause wobbles in the structure. When it wobbles one way "s1" is added to the list of shapes and when it wobbles the other way "s2" is added.</p>
<div class="highlight"><pre><span class="nt">&lt;rules</span> <span class="na">max_depth=</span><span class="s">&quot;20&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">count=</span><span class="s">&quot;100&quot;</span> <span class="na">transforms=</span><span class="s">&quot;rx 3.6&quot;</span> <span class="na">rule=</span><span class="s">&quot;R1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/rule&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;R1&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;sa 0.9 ry 6 tz 1&quot;</span> <span class="na">rule=</span><span class="s">&quot;R1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;instance</span> <span class="na">transforms=</span><span class="s">&quot;s 0.2 0.5 1&quot;</span> <span class="na">shape=</span><span class="s">&quot;s1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/rule&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;R1&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;sa 0.9 ry -6 tz 1&quot;</span> <span class="na">rule=</span><span class="s">&quot;R1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;instance</span> <span class="na">transforms=</span><span class="s">&quot;s 0.2 0.5 1&quot;</span> <span class="na">shape=</span><span class="s">&quot;s2&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/rule&gt;</span>
<span class="nt">&lt;/rules&gt;</span>
</pre></div>


<p>The names of these objects don't matter, they can be called anything in the xml.<code>LSystem_blender.py</code> passes the names to the node as strings. The node then converts these strings to integers (that is (0, 1) for two different objects, (0, 1, 2) for three objects etc.). This mask can be used as input to a "Mask List" node to separate the matrices into two lists as shown below. This is simple for two objects but is a bit more complicated but doable for more.</p>
<p>The "Levels List" on the "Mask List" node needs to be set to "2". That is because the outputs of the GA_node have been set up as a 2 level list. The first level corresponds to each arm of sub-part of the structure. The second level contains the actual output values. Examine the output with a "Viewer Text" node to help understand this.</p>
<p><img alt="GA node diagram with mask list" src="/images/mask_demo_01.blend.png" /></p>
<h2>Mesh output</h2>
<p>Using the matrices output allows a separate object to be placed at each location. The vertices input and the mesh (vertices, edges, faces) output "skins" the mesh into a much smaller number of objects. The vertices input should be a list of vertices such as that generated by the "Circle" node. It could also be a circle type object taking from the scene using the "Objects In" node. The list of vertices should be in order so they can be made into a ring with the last vertex joined to the first. That ring dosen't have to be planar.</p>
<p>If the vertices are taken from an object in the scene the vertices can be repositioned in "EDIT" and the structure updated by going to "OBJECT" mode then clicking the "Update Node Tree" button.</p>
<p><img alt="GA tube nodes and render/screenshot" src="/images/Fern.blend.png" /></p>
<p>The output will not always be one mesh. If the rule set ends one 'arm' and goes back to start another 'arm' these two sub-parts will be separate meshes. Sometimes the mesh does not turn out how you would like. This can often be fixed by changing the rule set. </p>
<p>Often a mesh tube will turn out flat rather than being tube like. This can usually be fixed by either rotating the vertex ring in the scene or by adding a rotation transform to the "instance" commands in the rule set. </p>
<p>For example change <code>&lt;instance shape="s1"/&gt;</code> to <code>&lt;instance transfroms="ry 90" shape="s1"/&gt;</code></p>
<p>In other cases the mesh can be connected in the wrong order.</p>
<p>My first attempt at the Fern structure had this effect.</p>
<div class="highlight"><pre><span class="nt">&lt;rules</span> <span class="na">max_depth=</span><span class="s">&quot;2000&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span>  <span class="na">rule=</span><span class="s">&quot;curl&quot;</span> <span class="nt">/&gt;</span>      
    <span class="nt">&lt;/rule&gt;</span>

    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;curl&quot;</span> <span class="na">max_depth=</span><span class="s">&quot;80&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;rx 12.5 tz 0.9 s 0.98 0.95 1.0&quot;</span> <span class="na">rule=</span><span class="s">&quot;curl&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;instance</span> <span class="na">shape=</span><span class="s">&quot;box&quot;</span><span class="nt">/&gt;</span>       
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;tx 0.1 ty -0.45 ry 40 sa 0.25&quot;</span> <span class="na">rule=</span><span class="s">&quot;curlsmall&quot;</span> <span class="nt">/&gt;</span>  
    <span class="nt">&lt;/rule&gt;</span>

    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;curlsmall&quot;</span> <span class="na">max_depth=</span><span class="s">&quot;80&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;rx 25 tz 1.2 s 0.9 0.9 1.0&quot;</span> <span class="na">rule=</span><span class="s">&quot;curlsmall&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;instance</span> <span class="na">shape=</span><span class="s">&quot;box&quot;</span><span class="nt">/&gt;</span>     
    <span class="nt">&lt;/rule&gt;</span>

<span class="nt">&lt;/rules&gt;</span>
</pre></div>


<p><img alt="fern wrong" src="/images/fern_wrong.blend.png" /></p>
<p>The following xml produces the result I was after that's shown with the node diagram above.</p>
<div class="highlight"><pre><span class="nt">&lt;rules</span> <span class="na">max_depth=</span><span class="s">&quot;2000&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;entry&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span>  <span class="na">rule=</span><span class="s">&quot;curl1&quot;</span> <span class="nt">/&gt;</span>  
        <span class="nt">&lt;call</span>  <span class="na">rule=</span><span class="s">&quot;curl2&quot;</span> <span class="nt">/&gt;</span>      
    <span class="nt">&lt;/rule&gt;</span>

    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;curl1&quot;</span> <span class="na">max_depth=</span><span class="s">&quot;80&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;rx 12.5 tz 0.9 s 0.98 0.95 1.0&quot;</span> <span class="na">rule=</span><span class="s">&quot;curl1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;instance</span> <span class="na">shape=</span><span class="s">&quot;box&quot;</span><span class="nt">/&gt;</span>        
    <span class="nt">&lt;/rule&gt;</span>

    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;curl2&quot;</span> <span class="na">max_depth=</span><span class="s">&quot;80&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;rx 12.5 tz 0.9 s 0.95 0.95 1.0&quot;</span> <span class="na">rule=</span><span class="s">&quot;curl2&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;tx 0.1 ty -0.45 ry 40 sa 0.25&quot;</span> <span class="na">rule=</span><span class="s">&quot;curlsmall&quot;</span> <span class="nt">/&gt;</span>     
    <span class="nt">&lt;/rule&gt;</span>    

    <span class="nt">&lt;rule</span> <span class="na">name=</span><span class="s">&quot;curlsmall&quot;</span> <span class="na">max_depth=</span><span class="s">&quot;80&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;call</span> <span class="na">transforms=</span><span class="s">&quot;rx 25 tz 1.2 s 0.9 0.9 1.0&quot;</span> <span class="na">rule=</span><span class="s">&quot;curlsmall&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;instance</span> <span class="na">shape=</span><span class="s">&quot;box&quot;</span><span class="nt">/&gt;</span>     
    <span class="nt">&lt;/rule&gt;</span>    
<span class="nt">&lt;/rules&gt;</span>
</pre></div>


<p>Both sets of xml rules produce the same list of matrices just in a different order.</p>
<p>The mesh output is very useful as further mesh operations or modifiers such as "Subdivision Surface" can then be used. Sub meshes can be joined together (CTRL-J) or booleans are sometimes successful if a single mesh is really required.</p>
<hr />	

	</article>

	<div class="comments">
	<h2>Comments !</h2>
	    <div id="disqus_thread"></div>
	    <script type="text/javascript">
	       var disqus_identifier = "structure-synth-meets-sverchok-mesh-mode.html";
	       (function() {
	       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	       dsq.src = 'http://lookthinkmake.disqus.com/embed.js';
	       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	      })();
	    </script>
	</div>

		  </div>	
		  
		  <div class="sidebar">

	        <nav>
		  <h2>Recent Posts</h2>
			<ul class="archive">
	
			      <li>
<a href="http://www.elfnor.com/blender-2d-maze-generator.html" rel="bookmark" title="Permalink to Blender 2D Maze Generator">Blender 2D Maze Generator</a>
  <time datetime="2015-12-11T22:00:00+13:00" pubdate>Fri 11 December 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/sverchok.html">sverchok  </a><a href="http://www.elfnor.com/tag/maze.html">maze  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/larger-hyperbolic-tilings-in-3d-using-processing.html" rel="bookmark" title="Permalink to Larger Hyperbolic Tilings in 3D using Processing">Larger Hyperbolic Tilings in 3D using Processing</a>
  <time datetime="2015-11-27T22:00:00+13:00" pubdate>Fri 27 November 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/processing.html">processing  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/symmetry-tile-painting-in-blender.html" rel="bookmark" title="Permalink to Symmetry Tile Painting in Blender">Symmetry Tile Painting in Blender</a>
  <time datetime="2015-11-21T22:00:00+13:00" pubdate>Sat 21 November 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/symmetrytile.html">symmetrytile  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/painting-in-the-hyperbolic-plane.html" rel="bookmark" title="Permalink to Painting in the Hyperbolic Plane">Painting in the Hyperbolic Plane</a>
  <time datetime="2015-11-14T22:00:00+13:00" pubdate>Sat 14 November 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/sverchok.html">sverchok  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/hyperbolic-tiling-in-3d.html" rel="bookmark" title="Permalink to Hyperbolic Tiling in 3D">Hyperbolic Tiling in 3D</a>
  <time datetime="2015-11-06T22:00:00+13:00" pubdate>Fri 06 November 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/sverchok.html">sverchok  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/shaders-for-sverchok-04-vertex-colors-update.html" rel="bookmark" title="Permalink to Shaders for Sverchok 04 - Vertex Colors Update">Shaders for Sverchok 04 - Vertex Colors Update</a>
  <time datetime="2015-10-02T22:00:00+13:00" pubdate>Fri 02 October 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/sverchok.html">sverchok  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/blender-linked-stars.html" rel="bookmark" title="Permalink to Blender Linked Stars">Blender Linked Stars</a>
  <time datetime="2015-09-27T22:00:00+13:00" pubdate>Sun 27 September 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a></p></a>      			      </li>
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
	
                        </u1>
		
		</nav>

	          <h2>Categories</h2>
	          <ul class = "social">
		      <li> <a href="http://www.elfnor.com/archives.html">everything </a></li>	
	              <li ><a href="http://www.elfnor.com/category/look.html">look</a></li>
	              <li ><a href="http://www.elfnor.com/category/make.html">make</a></li>
	              <li class="active"><a href="http://www.elfnor.com/category/think.html">think</a></li>
	          </ul>
	        

	          <aside>
	          <h2>Elsewhere</h2>
			    <ul class="social">
				  <li><a href="http://elfnor.deviantart.com">on deviant art</a><i></i></li>
				  <li><a href="http://www.thingiverse.com/elfnor">on thingiverse</a><i></i></li>
				  <li><a href="https://github.com/elfnor">on github</a><i></i></li>
			    </ul>
			  </aside>
                
                <h2>Tags</h2>
	
                        <ul class="tagcloud">
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/blender.html">blender</a></li>
                            <li class="tag-2"><a href="http://www.elfnor.com/tag/structuresynth.html">structuresynth</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/micropython.html">micropython</a></li>
                            <li class="tag-2"><a href="http://www.elfnor.com/tag/symmetrytile.html">symmetrytile</a></li>
                            <li class="tag-2"><a href="http://www.elfnor.com/tag/reading.html">reading</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/markdown.html">markdown</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/copy2.html">copy2</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/nonsense.html">nonsense</a></li>
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/think.html">think</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/python.html">python</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/cats.html">cats</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/maze.html">maze</a></li>
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/sverchok.html">sverchok</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/webalbum.html">webalbum</a></li>
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/make.html">make</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/geocaching.html">geocaching</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/ebook.html">ebook</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/pelican.html">pelican</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/processing.html">processing</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/3d-printing.html">3D Printing</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/kites.html">kites</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/materials.html">materials</a></li>
                        </ul>
                      
		
		  </div>

	  </div>

      <footer>
		<p role="contentinfo">
		  © 2013 elfnor - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-simplegrey"> pelican-simplegrey</a>, modified.
    	</p>

	  </footer>	

	</div>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=9900594; 
var sc_invisible=1; 
var sc_security="efb2c43c"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="free hit
counter" href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="http://c.statcounter.com/9900594/0/efb2c43c/1/"
alt="free hit counter"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</body>
</html>