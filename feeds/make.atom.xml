<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Look Think Make</title><link href="http://www.elfnor.com/" rel="alternate"></link><link href="http://www.elfnor.com/feeds/make.atom.xml" rel="self"></link><id>http://www.elfnor.com/</id><updated>2015-07-10T22:00:00+12:00</updated><entry><title>Micropython - OLED module with the ssd1306 chip</title><link href="http://www.elfnor.com/micropython-oled-module-with-the-ssd1306-chip.html" rel="alternate"></link><updated>2015-07-10T22:00:00+12:00</updated><author><name>elfnor</name></author><id>tag:www.elfnor.com,2015-07-10:micropython-oled-module-with-the-ssd1306-chip.html</id><summary type="html">&lt;p&gt;&lt;img alt="oled module" src="/images/wiring_02.png" /&gt;&lt;/p&gt;
&lt;p&gt;Small OLED modules are &lt;a href="http://www.dx.com/p/waveshare-0-96-oled-b-ssd1306-display-screen-module-deep-blue-340467#.VZ9gRqGW4y8"&gt;available&lt;/a&gt; with a resolution 128 x 64 pixels on a 22 x 11 mm display for under seven dollars. They are great for displaying graphics that can't be shown on a standard alphanumeric LCD. &lt;a href="https://en.wikipedia.org/wiki/OLED"&gt;OLED &lt;/a&gt; screens work without a back light and produce bright high contrast displays with a wide viewing angle (&amp;gt;160Â°) and low power consumption (~20 mA). The monochrome versions are available with a white or blue display on a black background, or as a version where the top quarter is yellow and the the rest blue.  The frame rates are very good and the display can be updated by the pyboard as fast as 333 frames/second.&lt;/p&gt;
&lt;p&gt;The driver chip included on these modules is a ssd1306 chip that can be set up to work with either a SPI or an I2C bus. Some modules come with only one bus wired up, other use a soldered jumper or resistor to select between the two bus types. I'm using a 128 x 64 pixel display using an SPI interface.&lt;/p&gt;
&lt;p&gt;There are some ssd1306 libraries available for micropython but I'm going to start with a basic example using only the micropython SPI class. I find writing a very simple example like this is a good way to understand the hardware and how to get the micro controller to work with it. Once I've got the simple example going I know my hardware and wiring are correct and I'm happy to use someone else's library to write more complicated stuff.&lt;/p&gt;
&lt;p&gt;The wiring for the OLED and pyboard are shown in the top diagram. The pyboard has two SPI ports, pins X5 to X8 on one side of the board and Y5 to Y8 on the other. The ssd1306 library defaults to the Y pins, but this can be changed in the module. The &lt;a href="https://en.wikipedia.org/wiki/Serial_Peripheral_Interface_Bus"&gt;SPI bus&lt;/a&gt; works faster than the I2C bus and has a separate line for master to slave (MOSI) communication than for slave to master (MISO). The ssd1306 on the OLED display (slave)  doesn't send any data back to the pyboard (master) so we don't need to connect this pin. The slave select (SS) or chip select (CS) line is not used by the micropython SPI class and can also be ignored. &lt;/p&gt;
&lt;h2&gt;Basic Example code&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;Simple test of a 128 x 64 pixel OLED display with an ssd1306 driver chip on a SPI bus&lt;/span&gt;

&lt;span class="sd"&gt;|OLED |PYB |&lt;/span&gt;
&lt;span class="sd"&gt;|VCC  |3V3 |&lt;/span&gt;
&lt;span class="sd"&gt;|GND  |GND|&lt;/span&gt;
&lt;span class="sd"&gt;|NC   |-- |&lt;/span&gt;
&lt;span class="sd"&gt;|DIN  |Y8 MOSI |&lt;/span&gt;
&lt;span class="sd"&gt;|CLK  |Y6 SCK |&lt;/span&gt;
&lt;span class="sd"&gt;|CS   | --|&lt;/span&gt;
&lt;span class="sd"&gt;|D/C  |Y4 |&lt;/span&gt;
&lt;span class="sd"&gt;|RES  |Y3 |&lt;/span&gt;
&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pyb&lt;/span&gt;

&lt;span class="c"&gt;# from adafruit arduino&lt;/span&gt;
&lt;span class="n"&gt;init_cmds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mh"&gt;0xAE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xD5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x80&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xA8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x3F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xD3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x8D&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x14&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x00&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xA1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xC8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="mh"&gt;0xDA&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x12&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x81&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xCF&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xd9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xF1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xDB&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xA4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xA6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0xAF&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="n"&gt;display_cmds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mh"&gt;0x21&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;127&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mh"&gt;0x22&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c"&gt;## set up SPI bus              &lt;/span&gt;
&lt;span class="n"&gt;rate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;8000000&lt;/span&gt;

&lt;span class="n"&gt;spi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SPI&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SPI&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MASTER&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;baudrate&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;rate&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;polarity&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;phase&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;dc&lt;/span&gt;  &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Y4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OUT_PP&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PULL_DOWN&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Y3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OUT_PP&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PULL_DOWN&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;write_command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    write single command byte to ssd1306&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;dc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;spi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;    

&lt;span class="c"&gt;## power on&lt;/span&gt;
&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c"&gt;## init display&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cmd&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;init_cmds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;write_command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c"&gt;## clear display&lt;/span&gt;
&lt;span class="nb"&gt;buffer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;bytearray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cmd&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;display_cmds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;write_command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;dc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;spi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c"&gt;## line grid&lt;/span&gt;
&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;  &lt;span class="c"&gt;# 8 horizontal lines&lt;/span&gt;

&lt;span class="c"&gt;# set every  16th byte to 255&lt;/span&gt;
&lt;span class="c"&gt;# should give 8 vertical lines&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;   
    &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;

&lt;span class="c"&gt;#color in the 1st block to see where it is&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;   
    &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;

&lt;span class="nb"&gt;buffer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;bytearray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;cmd&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;display_cmds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;write_command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cmd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;dc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;spi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;buffer&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;There are two list of command bytes. The first list &lt;code&gt;init_cmds&lt;/code&gt; sets up the screen and turns it on. The second set &lt;code&gt;display_cmds&lt;/code&gt; is used before sending an array of bytes to fill the screen display. The baud rate or clock frequency for the SPI bus does not seem to matter. I can get it to work from  at least 8 kHz to 16 MHz. Also the polarity and phase settings don't seem to matter here. &lt;/p&gt;
&lt;p&gt;The &lt;code&gt;dc&lt;/code&gt; pin is used to let the ssd1306 know whether the bytes coming down the &lt;code&gt;DIN&lt;/code&gt; line are commands (&lt;code&gt;dc&lt;/code&gt; high ) or data for the screen (&lt;code&gt;dc&lt;/code&gt; low). The &lt;code&gt;rs&lt;/code&gt; pin is used to reset the display when it is pulled low for 10 ms.&lt;/p&gt;
&lt;p&gt;The display is 128 x 64 pixels = 8192 bits where for each bit a 1 represents a pixel on and 0 a pixel off. The buffer for the display is written to using a byte array of 1024 bytes (8192/8). Each byte represents 8 pixels arranged in a vertical block. The bytes/blocks are ordered in rows of 128 across the display. The position of the first byte can be changed with the 13th byte of &lt;code&gt;init_cmds&lt;/code&gt;. Setting it to &lt;code&gt;0xA1&lt;/code&gt; puts the 1st byte in the top left corner, &lt;code&gt;0xB0&lt;/code&gt; puts the 1st byte in the top right.&lt;/p&gt;
&lt;p&gt;The example code draws a grid of 8 horizontal and 8 vertical lines on the screen and colors in the first block to check orientation.&lt;/p&gt;
&lt;h1&gt;ssd1306 library example&lt;/h1&gt;
&lt;p&gt;There are several versions and forks of a ssd1306 library for micropython on github. They all seem to be based on one originally written by &lt;a href="https://github.com/nvbn/micropython-drivers"&gt;Kenneth Henderick&lt;/a&gt;. I have used the version from the &lt;a href="https://github.com/jeffmer/micropython-upybbot"&gt;upybot project&lt;/a&gt; which adds a basic text display capability. The screen and pixel setting commands are written so that the origin is in the bottom left.&lt;/p&gt;
&lt;p&gt;I also found  a graphics library for drawing lines, triangles, rectangles and circles on this &lt;a href="http://forum.micropython.org/viewtopic.php?f=5&amp;amp;t=195&amp;amp;p=873&amp;amp;hilit=lcd_gfx#p873"&gt;forum post&lt;/a&gt; by polygontwist. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;# hello world on SSD1306&lt;/span&gt;
&lt;span class="c"&gt;# uses version of SSD1306.py and font.py&lt;/span&gt;
&lt;span class="c"&gt;# https://github.com/jeffmer/micropython-upybbot/blob/master/ssd1306.py&lt;/span&gt;
&lt;span class="c"&gt;# graphics library lcd_gfx.py from &lt;/span&gt;
&lt;span class="c"&gt;# http://forum.micropython.org/viewtopic.php?f=5&amp;amp;t=195&amp;amp;p=873&amp;amp;hilit=lcd_gfx#p873&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pyb&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;ssd1306&lt;/span&gt;  &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SSD1306&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;lcd_gfx&lt;/span&gt;

&lt;span class="n"&gt;oled&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SSD1306&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pinout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;dc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;X4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                       &lt;span class="s"&gt;&amp;#39;res&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;X3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
               &lt;span class="n"&gt;height&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
               &lt;span class="n"&gt;external_vcc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poweron&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init_display&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  
&lt;span class="c"&gt;## text&lt;/span&gt;
&lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Hello World!&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;55&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c"&gt;## draw straight lines&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;127&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;64&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pixel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;47&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;48&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;63&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;127&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; 
        &lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pixel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;             

&lt;span class="c"&gt;## whole buffer        &lt;/span&gt;
&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;   
    &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;255&lt;/span&gt;

&lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;bytearray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  
&lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; 

&lt;span class="c"&gt;## graphics example&lt;/span&gt;
&lt;span class="n"&gt;lcd_gfx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawCircle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lcd_gfx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawFillCircle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;91&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lcd_gfx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawLine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;63&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
&lt;span class="n"&gt;lcd_gfx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawLine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;63&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;85&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
&lt;span class="n"&gt;lcd_gfx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawFillTrie&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;63&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;63&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lcd_gfx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawTrie&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;63&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;63&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;78&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lcd_gfx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawRect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lcd_gfx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawFillRect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;122&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;58&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;oled&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This code displays some text, waits 2 seconds then adds some lines. It then displays the grid as in the first example and finishes off with examples of the shapes available in the &lt;code&gt;lcd_gfx.py&lt;/code&gt; library. Note that due to the way the method &lt;code&gt;pixel&lt;/code&gt; is implemented, the origin for all the graphics and text positions is the bottom left. However setting the raw buffer shows the screen origin is at the top right.&lt;/p&gt;
&lt;p&gt;After the text and graphics are set up using calls to &lt;code&gt;oled.text()&lt;/code&gt;, &lt;code&gt;oled.pixel()&lt;/code&gt;, or any of the &lt;code&gt;lcd_gfx&lt;/code&gt; functions, &lt;code&gt;oled.display&lt;/code&gt; is called to send the buffer to the display.&lt;/p&gt;
&lt;p&gt;The code for all these examples is available on my &lt;a href="https://github.com/elfnor/micropython-blog-examples"&gt;github repo&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The ssd1306 library can also be used with an OLED wired to use the I2C bus. &lt;/p&gt;
&lt;hr /&gt;</summary><category term="make"></category><category term="python"></category><category term="micropython"></category></entry><entry><title>Micropython - Stepper motor control with a A4988 carrier board</title><link href="http://www.elfnor.com/micropython-stepper-motor-control-with-a-a4988-carrier-board.html" rel="alternate"></link><updated>2015-07-03T22:00:00+12:00</updated><author><name>elfnor</name></author><id>tag:www.elfnor.com,2015-07-03:micropython-stepper-motor-control-with-a-a4988-carrier-board.html</id><summary type="html">&lt;p&gt;&lt;img alt="A4988 circuit" src="/images/A4988_circuit.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;I have a &lt;a href="https://micropython.org/"&gt;pyboard&lt;/a&gt; (I get cool birthday presents) and like the look of the micropython language. Python is my first language choice for data analysis at work and I've used it writing add ons for &lt;a href="http://elfnor.com/Symmetry%20Tile%20plug-in%20for%20GIMP.html"&gt;GIMP&lt;/a&gt; and &lt;a href="http://elfnor.com/blender-pipe-generator.html"&gt;Blender&lt;/a&gt;. I can program the &lt;a href="http://www.elfnor.com/Arduino%20Bread%20Details.html"&gt;Arduino&lt;/a&gt; in Wiring/Processing but being able to program a micro-controller in python is a big plus. The way the REPL prompt/terminal allows interactive scripting, putting a program on the board is just copying, and the ease of printing statements back to the terminal are all easier to use than the equivalent for the Arduino.&lt;/p&gt;
&lt;p&gt;Arduino of course has a much bigger user base and a huge resource of code libraries and tutorials. Pick up a sensor or motor control board and you can easily find the code to copy and paste and get it going. The pyboard has some great examples on their &lt;a href="docs.micropython.org/en/latest/tutorial/index.html"&gt;website&lt;/a&gt; and I've found some good github projects, &lt;a href="https://github.com/dhylands/upy-examples"&gt;dhylands examples&lt;/a&gt; and &lt;a href="https://github.com/mithru/MicroPython-Examples"&gt;mithru examples&lt;/a&gt; but more beginner friendly  stuff is needed.&lt;/p&gt;
&lt;p&gt;I'm working towards making a ball balancing robot potentially mashing this &lt;a href="https://github.com/jeffmer/micropython-upybbot"&gt;electronics and code&lt;/a&gt; with this &lt;a href="http://xrobots.co.uk/BB8/"&gt;hardware&lt;/a&gt;. I'm tackling this in small steps starting with the motors and will blog progress as I go.&lt;/p&gt;
&lt;p&gt;This post covers three ways to drive bipolar stepper motors through the A4988 chip. This chip is available on carrier boards such as the stepstick and polulu. These are used a lot in home built 3D printers and a set of four can be bought for under $12 on &lt;a href="http://www.dx.com/"&gt;http://www.dx.com/&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Connections&lt;/h2&gt;
&lt;p&gt;Connect the board to the stepper motor and pyboard as shown. The jumper between the &lt;code&gt;RESET&lt;/code&gt; and &lt;code&gt;SLEEP&lt;/code&gt; pins is important. So is the capacitor on the motor power supply. Put this close to the carrier board. &lt;/p&gt;
&lt;p&gt;The &lt;code&gt;ENABLE&lt;/code&gt; pin can be left unconnected. If the pin is unconnected or held low the motor will be braked when power is applied to the motor. If the enable pin is held high the motor is disabled or not braked. Keeping the motor braked draws power so setting the enable pin can be used to save power and reduce the heat of the board and motor.&lt;/p&gt;
&lt;p&gt;The carrier board takes one step for each pulse sent on the &lt;code&gt;STEP&lt;/code&gt; pin. The pin needs to be set high for at least 2 Âµs. The &lt;code&gt;DIR&lt;/code&gt; pin determines motor direction. &lt;code&gt;HIGH&lt;/code&gt; goes one way, &lt;code&gt;LOW&lt;/code&gt; the other. The board can also be used to do microstepping but I won't cover that here. &lt;/p&gt;
&lt;p&gt;The  potentiometer on the carrier board can be used to control the current through the motor. Clockwise increases the current and heat anti-clokwise does the opposite. See the &lt;a href="http://reprap.org/wiki/Pololu_stepper_driver_board"&gt;reprap wiki&lt;/a&gt; for details on adjusting this correctly. &lt;/p&gt;
&lt;h3&gt;Simple operation&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;Stepper motor control example using a A4988 carrier board &lt;/span&gt;
&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pyb&lt;/span&gt;

&lt;span class="n"&gt;dir_pin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Y1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OUT_PP&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;step_pin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Y2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OUT_PP&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;enable_pin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Y3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OUT_PP&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;enable_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  &lt;span class="c"&gt;# high is stop&lt;/span&gt;
&lt;span class="n"&gt;dir_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;     &lt;span class="c"&gt;# high is CCW looking down on shaft&lt;/span&gt;

&lt;span class="n"&gt;enable_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;step_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;udelay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;step_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;udelay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;dir_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;step_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;udelay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;step_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;udelay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;enable_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c"&gt;#Brake motor draws full current&lt;/span&gt;
&lt;span class="n"&gt;enable_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;enable_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This code is about as simple as it gets. The motor should take 1000 steps one way then a 1000 steps the other way at approximately 1000 steps/second. The speed is set by the length of the delay in `pyb.delay(1000). A larger delay means a slower speed. The enable pin is left low at the end so one can see the effect on braking the motor and the current draw from the motor power supply.&lt;/p&gt;
&lt;p&gt;This code could be re-factored into a function with parameters for number of steps, direction and speed but its use is limited to moving a single motor at a time. The code cannot easily do anything like check for end stops while the motor is running.&lt;/p&gt;
&lt;h3&gt;Timer operation&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;Stepper motor control example using a A4988 carrier board &lt;/span&gt;
&lt;span class="sd"&gt;and a Timer&lt;/span&gt;
&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pyb&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;disco&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    cycles LEDs on pyboard for ms milliseconds&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;leds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;LED&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;leds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;off&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;millis&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
       &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;millis&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
          &lt;span class="n"&gt;leds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toggle&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
          &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;leds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;off&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;motor_cb1&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;step_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;udelay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;step_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;dir_pin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Y1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OUT_PP&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;step_pin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Y2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OUT_PP&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;enable_pin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Y3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;OUT_PP&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;enable_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;  &lt;span class="c"&gt;# high is stop&lt;/span&gt;
&lt;span class="n"&gt;dir_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;     &lt;span class="c"&gt;# high is CCW looking down on shaft&lt;/span&gt;

&lt;span class="n"&gt;tim1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Timer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;freq&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;tim1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;motor_cb1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;tim1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;freq&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;enable_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;dir_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;low&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;disco&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;dir_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;disco&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;enable_pin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;high&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;tim1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deinit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The next level of sophistication is to use a timer that is called periodically to make each step. This allows multiple motors to be run at the same time and other code to be run in the time between steps.&lt;/p&gt;
&lt;p&gt;The above code uses a timer &lt;code&gt;tim1&lt;/code&gt; and a callback function &lt;code&gt;motor_cb1&lt;/code&gt;. The callback function makes a single step. The speed of the motor is set by the frequency of the timer in &lt;code&gt;tim1.init(freq = 1000)&lt;/code&gt;. A larger frequency will give a faster speed.&lt;/p&gt;
&lt;p&gt;To prove the program can do other things while turning the motor I'm calling the function &lt;code&gt;disco&lt;/code&gt; which cycles through the leds on the board.&lt;/p&gt;
&lt;p&gt;To run more then one motor you need a separate timer and callback function for each motor.&lt;/p&gt;
&lt;h3&gt;nemastepper.py library&lt;/h3&gt;
&lt;p&gt;The next step in refactoring this code to make a general library for stepper motors is to wrap the functionality up in a Class. Rather than do this myself I've used jeffmer's &lt;code&gt;nemastepper.py&lt;/code&gt; module available as part of &lt;a href="https://github.com/jeffmer/micropython-upybbot"&gt;this github repository&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;Stepper motor control example using a A4988 carrier board &lt;/span&gt;
&lt;span class="sd"&gt;and the nemastepper.py library available at &lt;/span&gt;
&lt;span class="sd"&gt;https://github.com/jeffmer/micropython-upybbot&lt;/span&gt;
&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pyb&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;disco&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    cycles LEDs on pyboard for ms milliseconds&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;leds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;LED&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;leds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;off&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;millis&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
       &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;millis&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="n"&gt;now&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;ms&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
          &lt;span class="n"&gt;leds&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toggle&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
          &lt;span class="n"&gt;pyb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;leds&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;off&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;nemastepper&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Stepper&lt;/span&gt;
&lt;span class="n"&gt;motor1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Stepper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Y1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Y2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Y3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyb&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Timer&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;step_cb&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;motor1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;do_step&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;tim&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Timer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;freq&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;tim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;step_cb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;#start interrupt routine&lt;/span&gt;

&lt;span class="n"&gt;motor1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MAX_ACCEL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;
&lt;span class="n"&gt;motor1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_speed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;disco&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  
&lt;span class="n"&gt;motor1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_speed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;motor1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_speed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;disco&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 

&lt;span class="n"&gt;motor1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_speed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;motor1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_off&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;tim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;deinit&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The &lt;code&gt;nemastepper&lt;/code&gt; module has a Class Stepper which is initialized with the pin names for the pyboard pins connected to the  dir pin, step pin and enable_pin (&lt;code&gt;motor1 = Stepper('Y1','Y2','Y3')&lt;/code&gt;). Other motors connected to other pins can be initialized with more instances of &lt;code&gt;Stepper&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The main program only needs one timer for any number of motors. The timer is set up with a frequency (f = 10000 Hz) much faster than the step rate. The callback function for this timer should call the &lt;code&gt;do_step&lt;/code&gt; method for each &lt;code&gt;Stepper&lt;/code&gt; instance. The speed (steps/second) of each motor is set with the &lt;code&gt;set_speed&lt;/code&gt; method. The sign of the speed determines the direction. The &lt;code&gt;do_step&lt;/code&gt; method uses the count and pulserate variables to decide when to take a step to achieve the required speed.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;MAX_ACCEL&lt;/code&gt; attribute of the &lt;code&gt;Stepper&lt;/code&gt; class sets the maximum acceleration of the motor. &lt;code&gt;set_speed&lt;/code&gt; will limit changes in speed to this value. I've set the &lt;code&gt;MAX_ACCEL&lt;/code&gt;to 1000 in the above example so the motor behavior is similar to the previous two examples. In a real application the desired maximum acceleration will depend on the load on the motor. Also in real application the motor speed will probably be ramped up and down in a loop rather than set to a single high value.&lt;/p&gt;
&lt;p&gt;The next step in improving the code would be to provide commands for moving a given number of steps in a given direction implementing acceleration and deceleration. The &lt;a href="http://www.airspayce.com/mikem/arduino/AccelStepper/"&gt;AccelStepper library&lt;/a&gt; for Arduino gives a good example of this approach but I don't know of such a library yet available for micropython.&lt;/p&gt;</summary><category term="make"></category><category term="python"></category><category term="micropython"></category></entry><entry><title>A Git Horror Story</title><link href="http://www.elfnor.com/a-git-horror-story.html" rel="alternate"></link><updated>2015-05-23T22:00:00+12:00</updated><author><name>elfnor</name></author><id>tag:www.elfnor.com,2015-05-23:a-git-horror-story.html</id><summary type="html">&lt;p&gt;&lt;img alt="git workflow" src="/images/Git_Workflow.jpeg" /&gt;&lt;/p&gt;
&lt;p&gt;While working on porting Structure Synth to Blender I came across &lt;a href="http://pdos.csail.mit.edu/scigen/"&gt;SCIgen&lt;/a&gt; which generates random computer science papers using methods that are similar to the way Structure Synth generates geometry. Some of these papers have been accepted at conferences or in journals.  This led to automatic text generators such as this &lt;a href="http://www.plot-generator.org.uk/"&gt;one&lt;/a&gt; which I guess just uses straight substitution into a defined story. To include my Generative Art version of Structure Synth in the Sverchok Blender add-on I had to learn a lot more about using Git on a collaborative project. Like many new users I had trouble with the Git command terms. Late one night (a dark and stormy night) these two things converged.&lt;/p&gt;
&lt;p&gt;Here's my &lt;a href="http://www.plot-generator.org.uk/lbs9ew/curse-of-fetched-repo.html"&gt;git horror story&lt;/a&gt; automatically generated by &lt;a href="http://www.plot-generator.org.uk/"&gt;Plot Generator&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;The Curse of the Fetched Repo&lt;/h2&gt;
&lt;h3&gt;A Horror Story&lt;/h3&gt;
&lt;h3&gt;by elfnor&lt;/h3&gt;
&lt;p&gt;Whilst investigating the death of a local issue, a public git called A. Contributor uncovers a legend about a supernaturally-cursed, fetched repo circulating throughout upstream. As soon as anyone uses the repo, he or she has exactly 31 days left to live.&lt;/p&gt;
&lt;p&gt;The doomed few appear to be ordinary people during day to day life, but when photographed, they look merged. A marked person feels like a checked out collaborator to touch.&lt;/p&gt;
&lt;p&gt;A. gets hold of the repo, refusing to believe the superstition. A collage of images flash into her mind: a blamed git balancing on a cloned issue, an old newspaper headline about a rebase accident, a hooded organization ranting about forks and a drinking well located in an open source place.&lt;/p&gt;
&lt;p&gt;When A. notices her branches have collaborator-like properties, she realises that the curse of the fetched repo is true and calls in her primary, a diff called B. User, to help.&lt;/p&gt;
&lt;p&gt;B. examines the repo and willingly submits himself to the curse. He finds that the same visions flash before his eyes. He finds the blamed git balancing on a cloned issue particularly chilling. He joins the queue for a supernatural death.&lt;/p&gt;
&lt;p&gt;A. and B. pursue a quest to uncover the meaning of the visions, starting with a search for the hooded organization. Will they be able to stop the curse before their time is up?&lt;/p&gt;
&lt;h2&gt;Praise for The Curse of the Fetched Repo&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;"This is actually pretty scary. I'll never be able to look at another fetched repo for as long as I live."
- The Daily Tale&lt;/p&gt;
&lt;p&gt;"Oh please! There's nothing scary about a blamed git balancing on a cloned issue. Are we supposed to feel spooked?"
- Enid Kibbler&lt;/p&gt;
&lt;p&gt;"The hooded organization really freaked me out."
- Hit the Spoof&lt;/p&gt;
&lt;p&gt;"I hope A. and B. get married."
- Zob Gloop
    &lt;code&gt;9+++++++++++++++++++++++++-------&lt;/code&gt;.
-&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr /&gt;</summary><category term="think"></category><category term="nonsense"></category></entry><entry><title>Arduino Bread Details</title><link href="http://www.elfnor.com/Arduino%20Bread%20Details.html" rel="alternate"></link><updated>2015-01-19T22:00:00+13:00</updated><author><name>elfnor</name></author><id>tag:www.elfnor.com,2015-01-19:Arduino Bread Details.html</id><summary type="html">&lt;p&gt;&lt;img alt="arduino bread" src="http://www.elfnor.com/images/arduino_bread.png" /&gt;&lt;/p&gt;
&lt;p&gt;As mentioned in a &lt;a href="http://www.elfnor.com/Arduino Bread.html"&gt;previous post&lt;/a&gt; I've been working on a project to replace the "brain" of a bread-maker with an Arduino. &lt;/p&gt;
&lt;p&gt;The aim is to separate out the different stages in the breadmaker's cycle so I can make good sourdough bread. In general the sourdough takes longer to rise than dough made using store bought dried yeast granules. The rise time can also vary depending on how the sourdough starter is on any day. Also the longer the rise time the stronger the sour flavour of the bread.&lt;/p&gt;
&lt;p&gt;This project is ongoing. Currently I have made a breadmaker with an Arduino brain where I can set up programs with my own times for any part of the breadmaker cycle. To make a loaf of sourdough, I put the ingredients in the pan and select a program that mixes and kneads the dough then keeps the pan at rise temperature indefinitely. When I've checked the bread is sufficiently risen, I stop that program and run a bake only program.  Eventually, I'd like some way of measuring the height of the dough so the Arduino can track when the bread is risen and then switch to the bake cycle. The current rise temperature is the same as for the original breadmaker cycle (~37 Â°C). I'll probably add an option to rise the bread at a lower temperature for longer to get a stronger sour flavour.&lt;/p&gt;
&lt;p&gt;The model of breadmaker I'm using is a fairly old Sanyo "The Bread Factory Plus" (Model SBM-20). From other people's projects I suspect many breadmakers are quite similar internally and these notes could be applicable to many other models and brands.&lt;/p&gt;
&lt;p&gt;First of all pull your breadmaker apart to see how it works. Keep all the screws and take photos during the take apart. These are great when you need to put it back together again.&lt;/p&gt;
&lt;p&gt;A breadmaker is very simple, it has a motor to turn the paddle and a heater to warm the pan and a thermistor to give the pan's temperature. There's a set of buttons and a display to select a program and start the machine. All this is controlled by a micro controller. &lt;/p&gt;
&lt;p&gt;&lt;img alt="take apart breadmaker" src="/images/bm_insides.jpeg" /&gt;&lt;/p&gt;
&lt;p&gt;In the above photo the top board contains the buttons, the display and the micro controller. The bottom board controls the motor and heater. This makes our development simple and safe. We can replace the top board where the maximum voltage is 5 V without going any where near the nasty mains voltage on the motor and heater. The 5 pin connector goes from the control board to the lower motor and heater board. The two pin connector goes to the thermistor on the side of the baking area. &lt;/p&gt;
&lt;p&gt;For safety don't plug the machine into mains voltage when it looks like the above photo. Instead put it back together as much as possible while still having access to the control board.&lt;/p&gt;
&lt;p&gt;&lt;img alt="workable breadmaker" src="/images/bm_workable.jpeg" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="control board" src="/images/control_board_original.jpeg" /&gt;&lt;/p&gt;
&lt;p&gt;Carefully poking around the 5 pin connector while the breadmaker is going, gives the following designations for the pins. Pin 1 is on the right in the above image.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;1 - GND
2 - + 5V
3 - buzzer
4 - heater
5 - motor
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Pins 4 and 5 are normally held at 5V but are pulled to GND when the heater or motor are operating. Pin 3 is directly connected to a piezo buzzer.&lt;/p&gt;
&lt;p&gt;We can check the temperature sensor is a thermistor by heating the sensor up (disconnected from the board) and reading the resistance between the two contacts with a DVM. The resistance should drop with an increase in temperature. This shows the &lt;a href="http://en.wikipedia.org/wiki/Thermistor#NTC"&gt;thermistor&lt;/a&gt; has a negative temperature coefficient. The relationship between thermistor resistance and temperature will most likely be non-linear over the range of temperatures (20 Â°C to 230 Â°C) we are interested in. We could try and calibrate the thermistor at known temperatures to characterise its temperature versus resistance curve but we really only need to know the resistance at two points, the rising temperature and the baking temperature. We'll find these out by making a loaf of bread while we record what the breadmaker does.&lt;/p&gt;
&lt;h2&gt;Designing a system to record the bread maker&lt;/h2&gt;
&lt;p&gt;We will need to design a system to record the heater, motor and thermistor signals while the bread maker makes a loaf of bread. Having done this we can then duplicate those signals with our new Arduino control system. &lt;/p&gt;
&lt;p&gt;A thermistor has two connections and is usually read by micro controller using a voltage divider circuit like one of these (the thermistor can either be between the pin and ground or between +5V and the pin):&lt;/p&gt;
&lt;p&gt;&lt;img alt="thermistor read schematic" src="/images/thermistor_read_schem.png" /&gt;&lt;/p&gt;
&lt;p&gt;Checking the thermistor circuit shows pin 2 at +5V so we're looking at something like the left most schematic above. However the resistor on Pin 1 of the thermistor is connected to ground via a transistor. The base pin of this transistor is controlled via another micro controller pin. Below is a simplified schematic.&lt;/p&gt;
&lt;p&gt;&lt;img alt="thermistor original" src="/images/thermistor_original.png" /&gt;&lt;/p&gt;
&lt;p&gt;What's happening here is that the micro controller regularly enables the voltage divider via a set of clock pulses sent on the control pin. If we measure the voltage on Pin 1 of the thermistor it will jump between the correct voltage (when the control pin is high) and ground. &lt;/p&gt;
&lt;p&gt;This makes the design of the recording system a little bit harder. We could try to synchronize our measurements with the clock signal on the microelectronic but as we're mainly interested in the steady state value of the thermistor at the rise and bake temperatures we can simplify this and use a capacitor to convert the voltage to a steady value.&lt;/p&gt;
&lt;p&gt;An Arduino can also be used for the recording system. The circuit I used is shown below. As this is only needed once I made it up on a bread board. Keep the original control board connected to the bread maker and add in this recording system to the control and thermistor connectors. Load up the breadmaker_record.ino sketch from the &lt;a href="https://github.com/elfnor/arduino-bread"&gt;github repository&lt;/a&gt; and make a loaf of bread!&lt;/p&gt;
&lt;p&gt;&lt;img alt="breadmaker record schematic" src="/images/breadmaker_record.png" /&gt;&lt;/p&gt;
&lt;h2&gt;Reverse Engineering a control system&lt;/h2&gt;
&lt;p&gt;The output of the recording system is shown below.&lt;/p&gt;
&lt;p&gt;&lt;img alt="bread maker output" src="/images/breadmaker_graph.png" /&gt;&lt;/p&gt;
&lt;p&gt;The motor control signals are straight forward. The loaf program starts with 6 minutes of mixing where the motor is pulsed on for ~0.25 second and off for ~1 second. After mixing the bread is kneaded with the motor on continuously for ~29 minutes. There is another two short pulses of the motor about a third of the way through the rising time. &lt;/p&gt;
&lt;p&gt;The analog count on pin A0 of the Arduino has an average of 120 during the rising time. For baking it has an average of 330. To convert these counts to resistance values, connect up variable resistor to the recording circuit in place of the thermistor. Vary the resistor to find the resistance values that give analog counts on the Arduino of 120 and 330. Allow enough time after each change in resistance for the count to reach a steady value as the circuit has a long response time due to the large smoothing capacitor.&lt;/p&gt;
&lt;p&gt;During the rising time the heater is on for an average 3 seconds and off for 60 seconds. The on cycle varies between 1 second and 10 seconds. The variation in the on cycle time is  used to control the temperature. &lt;/p&gt;
&lt;p&gt;When the pan is being heated for the baking time the heater is on continuously. During the baking the heater pulses on every 15 seconds with the pulse width again varied to control the temperature. After the baking time the breadmaker keeps the bread pan warm. I haven't yet implemented this keep warm feature in my Arduino program as I don't tend to use it.&lt;/p&gt;
&lt;p&gt;Controlling the temperature of the breadmaker with the Arduino consists of reading the temperature sensor (the thermistor) and determining when and for how long to turn on the heater. I avoided getting into most of the complications of control theory by starting with a very simple control algorithm.  For example for the rise control:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Temperature T&lt;/th&gt;
&lt;th&gt;time on&lt;/th&gt;
&lt;th&gt;time off&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;T &amp;lt; tlow&lt;/td&gt;
&lt;td&gt;10 s&lt;/td&gt;
&lt;td&gt;50 s&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tlow  &amp;lt; T &amp;lt; thigh&lt;/td&gt;
&lt;td&gt;6 s&lt;/td&gt;
&lt;td&gt;54 s&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;T &amp;gt; thigh&lt;/td&gt;
&lt;td&gt;1 s&lt;/td&gt;
&lt;td&gt;59 s&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;This works well enough because of the long time constant between pulsing the heater and the thermistor responding, the large thermal mass of the system, and the low accuracy (~ +/- 5 Â°C) required to make bread.&lt;/p&gt;
&lt;p&gt;In the control system the thermistor is measured with a simple voltage divider. The motor and heater are controlled via transistors connected to digital lines on the Arduino.&lt;/p&gt;
&lt;p&gt;The final circuit is shown below:&lt;/p&gt;
&lt;p&gt;&lt;img alt="breadmaker circuit" src="/images/breadmaker_schem.png" /&gt;&lt;/p&gt;
&lt;p&gt;This includes 5 switches to match the switches in use on the original breadmaker and a 4 digit display. The switches use the internal pull-up resistors on the Arduino board and so only need to be connected between the Arduino pin and ground. The 4 digit display is one that includes a TM1637 control chip (&lt;a href=""&gt;for example&lt;/a&gt;) and can be controlled from 2 lines on the Arduino. The LEDs in parallel with the transistors are useful for debugging the circuit and program but can be omitted in the final build.&lt;/p&gt;
&lt;p&gt;I made the fairly simple circuit board up on a piece of perfboard cut to match the size of the original board. The switches were carefully positioned to be in the same place underneath the pads on the breadmaker cover. The display was hung off the board on longish wires as this was the easiest way to get it to sit underneath the see through area on the cover. The Arduino nano was inserted into headers soldered onto the back of the board. This was to allow easy access for reprogramming. &lt;/p&gt;
&lt;p&gt;&lt;img alt="new board" src="/images/breadmaker_board.png" /&gt;&lt;/p&gt;
&lt;p&gt;The full code for the Arduino is available &lt;a href="https://github.com/elfnor/arduino-bread"&gt;here&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;When the bread maker is switched on with its new brain it behaves very much like it used to. Only now it has new programs as defined in the Arduino code. The programs are selected by using the SELECT button to cycle through them. The up and down keys can be used as before to add a delay time to the start of the program. The program is then started with the START button. It can be stopped at any time with the STOP button. &lt;/p&gt;
&lt;p&gt;The given Arduino code currently includes the following bread programs:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;struct PGRMS
  {
    int min_pulseMix;  // 1/4 second pulse every 1 second
    int min_contMix;   // continuous kneading
    int min_rise1;     // pan kept at rising temperature 
    int min_punchDown; // two short mixing pulses 
    int min_rise2;     // 2nd rise 
    int min_heat;      // pan heated up to bake temperature 
    int min_bake;      // pan kept at bake temperature 
  };

const int N_PGRMS = 6;

const PGRMS pgrms[N_PGRMS] = 
    {
      {6, 29, 30, 1, 53, 8, 42},  // 0 : normal loaf
      {6, 29, 0, 0, 0, 0, 0},     // 1 : mix and knead only
      {0,  0, 1000, 0, 0, 0, 0},  // 2 : very long rise
      {6, 29, 1000, 0, 0, 0, 0},  // 3 : mix, knead and long rise
      {0, 0, 0, 0, 0, 8, 42},     // 4 : bake only
      {3,  3, 10, 0,  0, 0,  0},  // 5 : test nonsense     
    };
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The first program &lt;code&gt;pgrms[0]&lt;/code&gt; bakes an ordinary loaf of bread, mixing it for 6 minutes, kneading for 29 minutes, rising for 30 mintute. Then it quickly "punches down" the bread (two short mixing pulse) and rises the bread for another 53 minutes. Then it heats the pan up and bakes the bread for 42 minutes. Any part of the program can be skipped by setting its value to zero. &lt;/p&gt;
&lt;p&gt;Add another program by increasing &lt;code&gt;N_PGRMS&lt;/code&gt; and adding a line to &lt;code&gt;PGRMS&lt;/code&gt; with the correct times for each part of the cycle.&lt;/p&gt;
&lt;p&gt;The next thing I'd like to add to this project is a sensor to determine when the bread is risen. Either a simple optical beam break when the bread reaches the top of the pan or some way of measuring the height of the dough. Choice of sensors will be limited by the high temperatures the breadmaker reaches. But for now my re-brained bread maker makes a pretty good loaf of bread.&lt;/p&gt;
&lt;hr /&gt;</summary><category term="make"></category></entry><entry><title>Arduino Bread</title><link href="http://www.elfnor.com/Arduino%20Bread.html" rel="alternate"></link><updated>2014-12-12T22:00:00+13:00</updated><author><name>elfnor</name></author><id>tag:www.elfnor.com,2014-12-12:Arduino Bread.html</id><summary type="html">&lt;p&gt;I'm working on a project to replace the "brain" of a bread-maker with an Arduino. &lt;/p&gt;
&lt;p&gt;My partner makes all the household's bread from a sourdough starter. He uses the current bread-maker to knead the bread and sometimes to bake the bread but a bread-maker with its fixed cycle doesn't't make a successful loaf of sourdough. The rising time for bread made with sourdough starter is variable and unpredictable. Also the standard bread-maker cycle has a "punch down" (a quick mix in the middle of the rising cycle). This helps to make a fine texture for ordinary bread but can disrupt the rising of a sourdough loaf.&lt;/p&gt;
&lt;p&gt;By replacing the bread-maker control circuit with an arduino, we'll have more control over the stages in the bread-maker cycle. For instance a leave to rise until the human baker switches to the bake cycle will cover the variation in rise time we often get with the sourdough. Eventually, I'd like some way of measuring the height of the dough so the arduino can track when the bread is risen and then switch to the bake cycle. &lt;/p&gt;
&lt;p&gt;Also a programmable temperature environment with optional mixing has potential for other projects. Pasta dough, jam, dyeing wool, risotto, &lt;a href="https://www.youtube.com/watch?v=wgUw5Sj5HK0"&gt;beer making&lt;/a&gt;, &lt;a href="http://hackaday.com/2010/01/29/another-take-on-roasting-those-beans/"&gt;roasting coffee&lt;/a&gt;, &lt;a href="http://www.instructables.com/id/Mr-Compost-How-to-make-an-in-kitchen-compost-tur/"&gt;compost&lt;/a&gt;, desoldering etc.&lt;/p&gt;
&lt;p&gt;Note : don't try these in the same bread-maker or at least don't make the jam after trying the desolder or compost. Note I only found the compost making instructable after I'd mostly finished my version, (for some reason I didn't search for compost and bread machine) but it looks a great place to start. What's interesting is the basic board layout in the compost making Zojirushi BBCC-V20 looks similar internally to the Sanyo "The Bread Factory Plus" (Model SBM-20) I'm working on.&lt;/p&gt;
&lt;p&gt;I'll post some detailed notes when I'm a bit further along in the project. But so far I've managed to duplicate the basic bread-making cycle on the arduino. Here's the proof. Arduino baked bread.&lt;/p&gt;
&lt;p&gt;&lt;img alt="arduino bread" src="http://www.elfnor.com/images/arduino_bread.png" /&gt;&lt;/p&gt;
&lt;hr /&gt;</summary><category term="make"></category></entry><entry><title>Notes to Father Christmas re 3D Printer Filament</title><link href="http://www.elfnor.com/notes-to-father-christmas-re-3d-printer-filament.html" rel="alternate"></link><updated>2014-11-30T22:00:00+13:00</updated><author><name>elfnor</name></author><id>tag:www.elfnor.com,2014-11-30:notes-to-father-christmas-re-3d-printer-filament.html</id><summary type="html">&lt;p&gt;I was doing some research to help Father Christmas fill my request for "some interesting printer filament" in my Christmas stocking. I thought I'd share that research here in case its useful to anyone else. Feel free to include or modify it for your own Christmas letter to Santa. (Under a creative commons share alike license.)&lt;/p&gt;
&lt;p&gt;I have an Ultimaker original which takes 3 mm diameter filament and as my heated bed is currently in use &lt;a href="http://www.elfnor.com/a-novel-use-for-a-3d-heated-printer-bed.html"&gt;keeping the ducklings warm&lt;/a&gt;, I'm mainly looking at filaments that will print on an unheated bed.&lt;/p&gt;
&lt;p&gt;As I'm in New Zealand I've looked at filaments available locally. I have to consider the &lt;a href="http://visual.ly/santas-carbon-footprint"&gt;carbon emissions&lt;/a&gt; for sleigh travel from the North Pole. &lt;/p&gt;
&lt;p&gt;I'm also looking for "interesting" filament by this I mean something other than plain coloured ABS or PLA. If a supplier also stocks the plain stuff I've normally included their base price in the list below, but I haven't included any suppliers that just stock ABS and PLA.&lt;/p&gt;
&lt;p&gt;If you know of any other NZ stockists of interesting filament please add a comment.
I've tried to get the prices correct, including GST but not necessarily shipping. Add any corrections in a comment and I'll fix.&lt;/p&gt;
&lt;h2&gt;&lt;a href="http://diamondage.co.nz"&gt;Diamond Age&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Diamond Age have ASA ($78.20/125 m) a UV stabilised version of ABS which needs the same equipment to print as ABS.&lt;/p&gt;
&lt;p&gt;HIPS (High Impact Polystyrene) ($71.88/125 m) which is used in dual extrudes as a support material for ABS.&lt;/p&gt;
&lt;p&gt;PET-G (no heated bed required) ($94.88/125 m) is a transparent clear.&lt;/p&gt;
&lt;p&gt;IMPLA and HIPLA ($57.50/125 m), these are PLA with additives to increase strength and reduce brittleness. I've tried the HIPLA and its certainly flexible in the filament but can delaminate when a printed piece is flexed too much.  &lt;/p&gt;
&lt;p&gt;Diamond Age has PLA for ($50.88/125 m). The Ivory prints very nicely. The 125 m spools of 3 mm diameter filament are approximately 1 kg.  &lt;/p&gt;
&lt;p&gt;Diamond Age have the best tips on printing each filament of any of the NZ suppliers. They make their own filaments here in NZ and have a lot of experience in 3D printing. &lt;/p&gt;
&lt;h2&gt;&lt;a href="http://www.mindkits.co.nz"&gt;Mindkits&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Mindkits probably have the largest range of filament types, all non-branded.  &lt;/p&gt;
&lt;p&gt;Mindkits have:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;3 mm wood PLA ($50.47/kg), &lt;/li&gt;
&lt;li&gt;TPE Flexible filament ($87.92/kg), &lt;/li&gt;
&lt;li&gt;PLA filament that changes color with temperature ($64.50/kg), &lt;/li&gt;
&lt;li&gt;PETG T-glase ($69.30/kg), &lt;/li&gt;
&lt;li&gt;Nylon ($59.75/kg), &lt;/li&gt;
&lt;li&gt;Conductive ABS ($69.44/kg).  &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Mindkits price for ordinary PLA is around $50/kg.  &lt;/p&gt;
&lt;h2&gt;&lt;a href="http://nicegear.co.nz/3d-printing/"&gt;Nicegear&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Nicegear have NinjaFlex in 3 mm diameter (black and white) ($110/0.75 kg). I've seen some nice stuff printed in this. I've got some FilaFlex which I've found hard but not impossible to print with the Ultimaker's Bowden tube extruder. When my partner's Reprap is done I'll try the direct extruder and see if I get better results. Until then I'll pass on getting more flexible filament.&lt;/p&gt;
&lt;p&gt;Nicegear's price for ordinary PLA is $84/kg.&lt;/p&gt;
&lt;h2&gt;&lt;a href="https://www.noelleeming.co.nz"&gt;Noel Lemming&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Noel Lemming's have Makerbot PETG ($69.99/kg).&lt;/p&gt;
&lt;h2&gt;&lt;a href="http://www.reeltoreal.co.nz"&gt;Reel to Real&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Reel to Real only have black and white ABS/PLA in 3mm ($42/kg). They also have:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;wood ABS ($65/kg) in 1.75 mm diameter &lt;/li&gt;
&lt;li&gt;flexi ABS (1.75 mm)&lt;/li&gt;
&lt;li&gt;conductive ABS (1.75 mm) ($65/0.5kg).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;a href="http://www.vivenda.co.nz/buildingMaterial/"&gt;Vivenda&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Vivenda have &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Taulman 618 Nylon ($55/0.45 kg), &lt;/li&gt;
&lt;li&gt;645 Nylon ($72.50/0.45 kg) &lt;/li&gt;
&lt;li&gt;t-glase ($79.90/0.45 kg) all in 3 mm diameter (and 1.75 mm). &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The T-glase looks like it might require a heated printer bed. &lt;/p&gt;
&lt;hr /&gt;</summary><category term="make"></category><category term="3D Printing"></category></entry><entry><title>A novel use for a 3D heated printer bed.</title><link href="http://www.elfnor.com/a-novel-use-for-a-3d-heated-printer-bed.html" rel="alternate"></link><updated>2014-11-12T22:00:00+13:00</updated><author><name>elfnor</name></author><id>tag:www.elfnor.com,2014-11-12:a-novel-use-for-a-3d-heated-printer-bed.html</id><summary type="html">&lt;p&gt;My partner came home from his run on Saturday with a box full of baby ducklings he'd rescued from certain death by cat. The mother duck was nowhere to be found. After ringing partner's mother and googling duckling care (the two best sources of information) the ducklings were homed in a large box (ex radio controlled plane). We used a lamp with the only old style incandescent bulb we had to keep them warm and fed them up on chick feed begged from neighbours who keep chickens. &lt;/p&gt;
&lt;p&gt;This worked well for a couple of days until I got to thinking of a more efficient way to keep them warm...&lt;/p&gt;
&lt;p&gt;&lt;img alt="design" src="http://www.elfnor.com/images/DuckWarmer.png" /&gt;&lt;/p&gt;
&lt;p&gt;A while ago I'd built a heated bed for my Ultimaker 3D printer following a design similar to &lt;a href="http://www.thingiverse.com/thing:12727"&gt;this one&lt;/a&gt;. Mine had stripboard soldered in parallel in sets of four then those sets wired in series to give and overall resistance of about 3.5 Ohms. I sandwiched the board between the glass from the door of a small bench top oven (with thermal paste) and some wool insulation and MDF board on the other side. &lt;/p&gt;
&lt;p&gt;With 19 V across the stripboard, the glass surface could reach 230 deg C after a long warm up time (20+ minutes) and was controlled by the provided circuit on the Ultimaker board. It worked, but was mostly unused as I mainly print in PLA and I got better at the tricks to make prints stick to the original unheated acrylic bed.  &lt;/p&gt;
&lt;p&gt;&lt;img alt="heater" src="http://www.elfnor.com/images/duckling_heater_crop.png" /&gt;&lt;/p&gt;
&lt;p&gt;So this looked perfect for a new use. A bit of experimenting with a controlled voltage power supply and a thermocouple showed I could get a consistent 30 to 35 deg C temperature at a constant 6 V without any need for a control circuit. Perfect for our new fosterlings. I swapped a car battery charger for the fancy power supply, wrapped the bed well in fleece (ducklings are messy) and installed it in the ducklings' box. After a day of duckling satisfaction testing we built an insulated enclosure over half the bed to provide them with a choice of a warmer enclosed space.&lt;/p&gt;
&lt;p&gt;&lt;img alt="ducklings" src="http://www.elfnor.com/images/ducklings_crop_02.png" /&gt;&lt;/p&gt;
&lt;p&gt;Result, Happy Ducklings.&lt;/p&gt;</summary><category term="make"></category></entry><entry><title>Image alignment with markdown</title><link href="http://www.elfnor.com/image-alignment-with-markdown.html" rel="alternate"></link><updated>2014-06-21T22:00:00+12:00</updated><author><name>elfnor</name></author><id>tag:www.elfnor.com,2014-06-21:image-alignment-with-markdown.html</id><summary type="html">&lt;p&gt;The standard syntax for inserting an image into a markdown document &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;![avatar]({filename}/images/El_Avatar2.jpeg)
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;produces this html:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;p&amp;gt;&amp;lt;img&lt;/span&gt; &lt;span class="na"&gt;alt=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;avatar&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;./images/El_Avatar2.jpeg&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;and aligns an image to the left margin.&lt;/p&gt;
&lt;p&gt;&lt;img alt="avatar" src="http://www.elfnor.com/images/El_Avatar2.jpeg" /&gt;&lt;/p&gt;
&lt;p&gt;The text then continues underneath the image.&lt;/p&gt;
&lt;p&gt;To float an image left or right so that the text flows around the image you can include a style in the attribute list after the image filename.  Pelican automatically has the Attribute Lists extension to markdown enabled.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;![avatar]({filename}/images/El_Avatar2_face_left.jpeg){: style=&amp;quot;float:right; margin: 20px 20px&amp;quot;}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;produces this html:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;p&amp;gt;&amp;lt;img&lt;/span&gt; &lt;span class="na"&gt;alt=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;avatar&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;./images/El_Avatar2_face_left.jpeg&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;style=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;float:right; margin: 20px 20px&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;
&lt;p&gt;&lt;img alt="avatar" src="http://www.elfnor.com/images/El_Avatar2_face_left.jpeg" style="float:right; margin: 20px 20px" /&gt;&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;img alt="avatar" src="http://www.elfnor.com/images/El_Avatar2.jpeg" style="float:left; margin: 20px 20px" /&gt;&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Better practive would be to define a pair of styles in the &lt;code&gt;main.css&lt;/code&gt; file:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;/* Images */&lt;/span&gt;
&lt;span class="nc"&gt;.floatright&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;float&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;right&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;margin&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;20px&lt;/span&gt; &lt;span class="m"&gt;20px&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;border&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;2px&lt;/span&gt; &lt;span class="k"&gt;solid&lt;/span&gt; &lt;span class="m"&gt;#ccc&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nc"&gt;.floatleft&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;float&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;left&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;margin&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;20px&lt;/span&gt; &lt;span class="m"&gt;20px&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;border&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;2px&lt;/span&gt; &lt;span class="k"&gt;solid&lt;/span&gt; &lt;span class="m"&gt;#ccc&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then reference this in the markdown as follows:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;![avatar]({filename}/images/El_Avatar2_face_left.jpeg){: .floatright}
&lt;/pre&gt;&lt;/div&gt;


&lt;hr /&gt;
&lt;p&gt;&lt;img alt="avatar" class="floatright" src="http://www.elfnor.com/images/El_Avatar2_face_left.jpeg" /&gt;&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.&lt;/p&gt;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;There is a pelican plugin called &lt;a href="http://duncanlock.net/blog/2013/05/29/better-figures-images-plugin-for-pelican/"&gt;Better Figures and Images&lt;/a&gt; but it seems only designed for writing in reStructured Text not markdown.&lt;/p&gt;</summary><category term="think"></category><category term="pelican"></category><category term="markdown"></category></entry><entry><title>Cat Scan</title><link href="http://www.elfnor.com/Cat%20Scan.html" rel="alternate"></link><updated>2014-06-13T22:00:00+12:00</updated><author><name>elfnor</name></author><id>tag:www.elfnor.com,2014-06-13:Cat Scan.html</id><summary type="html">&lt;p&gt;The next step on from all the &lt;a href="http://www.elfnor.com/material-cats.html"&gt;Material Cats&lt;/a&gt; was to make a cat on my 3D printer (an &lt;a href="https://www.ultimaker.com/"&gt;Ultimaker original&lt;/a&gt;). This required a 3D model of the cat. Years ago I played around with  a home built laser scanner using the software from this project (&lt;a href="http://www.david-3d.com/"&gt;David laser scanner&lt;/a&gt;), but the model results required a lot of painstaking clean up and I moved on to something else. Also 3d scanning is a bit close to my day job to spend too much of my own time on it.&lt;/p&gt;
&lt;p&gt;More recently I've seen lots of blog posts on making 3D models from large collections of photos as well as using devices based on Kinect sensor.&lt;/p&gt;
&lt;p&gt;The most mentioned software for making a model from photos (photogrametry) is &lt;a href="http://www.123dapp.com/catch"&gt;Autodesk's 123d Catch&lt;/a&gt;. I gave it a go using the plaster cat as a model and was really surprised at the quality of the mesh I got for the effort put in.&lt;/p&gt;
&lt;p&gt;Basically you take a large number of photos of an object from all angles, then feed these into the software which analyses them. By matching points in the photos, the software determines where the camera was for each shot and what the 3D shape of the object is.&lt;/p&gt;
&lt;p&gt;The first step is to take photos. Like a lot of photo shoots its best to put some effort in to getting this right as fixing bad photos always takes longer than taking good photos in the first place. These &lt;a href="https://i.materialise.com/blog/entry/guest-blog-deepak-mehta-123dcatch-it-if-you-can"&gt;tips&lt;/a&gt; and &lt;a href="http://forum.123dapp.com/123d/topics/shooting_tips_for_123d_catch"&gt;these&lt;/a&gt; are a good place to start. I choose to take photos of the plaster model of the cat because it had an evenly coloured non reflective surface. I used some plasticine to stick it to the top of a bottle so I'd be able to get photos of the underside of the cat.&lt;/p&gt;
&lt;p&gt;Some people use fancy rigs for the camera but I just used a mini-tripod and worked on the floor. I drew a circle on the newspaper and marked of 18 positions even divisions around the circle. For each photo I placed the front leg of the tripod on a division and took a photo. The newspaper gives lots of detail in each shot for the software to work out camera positions. I took photos at three heights, one level with the cat, one looking doen on it and one looking up. I used a couple of desk lamps to evenly light the model. I made sure each photo was taken with the same zoom level, but didn't take any precautions to fix the exposure or aperture. (I was using an Olympus mu 790).&lt;/p&gt;
&lt;p&gt;&lt;img alt="Cat Scan Setup" src="http://www.elfnor.com/images/setup_cat_scan.jpeg" /&gt;&lt;/p&gt;
&lt;p&gt;This gave me 54 photos. Some of these photos were out of focus so I deleted them. This left me with 49 OK photos.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Example Photo" src="http://www.elfnor.com/images/example_photo.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;The autodesk web app requires google chrome on a windows machine. This was a nuisaance as I almost only run linux at home. But using a borrowed machine I used the web app to upload the photos. The instructions provided are pretty straight forward.&lt;/p&gt;
&lt;p&gt;Upload the photos:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Upload screenshot" src="http://www.elfnor.com/images/123_screen-02.png" /&gt;&lt;/p&gt;
&lt;p&gt;The model produced has the 3D mesh with the colours from the photos mapped onto the mesh.&lt;/p&gt;
&lt;p&gt;&lt;img alt="123D screenshot" src="http://www.elfnor.com/images/123_screen-01.png" /&gt;&lt;/p&gt;
&lt;p&gt;The 3D model produced includes the newspaper part of the bookcase and some of the couch. The cat sitting on its bottle is the very small white piece in the centre of the above screen capture.&lt;/p&gt;
&lt;p&gt;I installed and played around with the autodesk tools for cleaning up the image, but found them a bit cumbersome to use. Instead I exported the model as a stl file and cleaned it up in &lt;a href="http://www.blender.org"&gt;Blender&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Blender screenshot" src="http://www.elfnor.com/images/screen-02_web.png" /&gt;&lt;/p&gt;
&lt;p&gt;The model mesh imported into blender with the cat and support selected.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Blender screenshot 2" src="http://www.elfnor.com/images/screen-03_web.png" /&gt;&lt;/p&gt;
&lt;p&gt;Everything but the cat and support deleted&lt;/p&gt;
&lt;p&gt;First I deleted everything extra in the imported mesh.&lt;/p&gt;
&lt;p&gt;I then used a boolean operation with a cube to remove the support from the cat and give it a flat base suitable for printing.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Blender screenshot 3" src="http://www.elfnor.com/images/screen-04_web.png" /&gt;&lt;/p&gt;
&lt;p&gt;There were a few pimple shaped artifacts and a few dings which I cleaned up by deleting mesh triangles and then filling the gap. I also smoothed the mesh a bit and scaled it to match the original size.&lt;/p&gt;
&lt;p&gt;To distinguish cats made from the digital model from the cats made from the silicon mould, I transformed the mesh to its mirror image.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Blender screenshot 4" src="http://www.elfnor.com/images/cat_scan5-blend_web.png" /&gt;&lt;/p&gt;
&lt;p&gt;Here's the final digital model and a set of three printed cats at 100%, 75% and 50% of original size. Making scale copies is so much easier in a digital process.&lt;/p&gt;
&lt;p&gt;&lt;img alt="PLA Cat prints" src="http://www.elfnor.com/images/cat_scan_pla.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;The printed cat is reasonably similar to the original, the indent above the tail is not nearly as deep or as sharp as the original. A concave indent in a object is harder for photogrametry to capture than the outside contour of the object.&lt;/p&gt;
&lt;p&gt;Overall I was very pleased with how well the model turned out for the effort involved. Particularly how little clean up the mesh required.&lt;/p&gt;
&lt;p&gt;Next I'd like to try the &lt;a href="http://arc-team-open-research.blogspot.com.br/2012/12/how-to-make-3d-scan-with-pictures-and.html"&gt;open source alternatives&lt;/a&gt;, particularly the python photogrametry toolbox &lt;/p&gt;</summary><category term="cats"></category><category term="make"></category><category term="materials"></category><category term="3D printing"></category></entry><entry><title>Material Cats</title><link href="http://www.elfnor.com/material-cats.html" rel="alternate"></link><updated>2014-02-23T22:00:00+13:00</updated><author><name>elfnor</name></author><id>tag:www.elfnor.com,2014-02-23:material-cats.html</id><summary type="html">&lt;p&gt;I had a friend who after some self-reflection decided his primary hobby wasn't wood work but was collecting wood working tools. This left him feeling much less guilty about the number of wood working planes he had in his shed.&lt;/p&gt;
&lt;p&gt;If I was honest my major hobby or interest is collecting techniques for making things as much as actually making stuff. I've been to a lot of workshops and researched a lot of techniques on the web. A while back I started documenting some of these using the same cat mould for any technique that I possibly could.&lt;/p&gt;
&lt;p&gt;Here's the collection so far:&lt;/p&gt;
&lt;p&gt;&lt;img alt="collected cats" src="http://www.elfnor.com/images/collected_cats.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;The original cat is the grey and brown cat shown here. She was modeled in clay, burnished and saggar fired in an electric kiln.&lt;/p&gt;
&lt;p&gt;&lt;img alt="raku cat" src="http://www.elfnor.com/images/raku_cat.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;For a saggar firing the piece is placed inside a larger pot filled with sawdust, wood shavings and colourants such as copper sulphate and copper wire. The pot is sealed and fired in an electric kiln. This give a reducing atmosphere (not enough oxygen for clean burning). The colourants used in ceramics, produce different colours in a reducing atmosphere than they do in a normal electric kiln firing. The process produces a bit of smoke outside the kiln. The kiln I fired this in was in a garage on a school site so we got away with it. The kilns I use now are in a community arts facility inside a building and I can't do saggar firings there. I like the randomness of this type of process, the result isn't known until the piece is taken from the kiln. Pit firing and raku firing are other processes I enjoy for their random or serendipitous results.&lt;/p&gt;
&lt;p&gt;&lt;img alt="cat mould" src="http://www.elfnor.com/images/cat_mould.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;The mould is made in two parts. The inner part is flexible and is made with co-polymer sealant (the clear stuff you buy at the hardware store for sealing bathroom tiles). Professional mould makers use expensive (at least here in NZ) two-part silicon moulding compounds. Sealant is way cheaper and easier to get. The cons are its thick consistency make it easy to trap air against the mould, giving unsightly pimples on the casting. Also the  sealant sets by releasing a gas, so thick layers can take a long time (or forever) to cure. Years ago I picked up a tip&lt;sup id="fnref:1"&gt;&lt;a class="footnote-ref" href="#fn:1" rel="footnote"&gt;1&lt;/a&gt;&lt;/sup&gt; to add mineral turpentine to the sealant to thin it. This can then be painted on as a thin layer on to the object being cast. Allow this first thin layer to dry. It will take a lot longer than plain sealant due to the turps. When its dry build up the mould with more plain sealant filling in all the gaps until there are no undercuts. Let this dry again.&lt;/p&gt;
&lt;p&gt;When the sealant is dry an outer "mother mould" of plaster is made to support the sealant inner mould.&lt;/p&gt;
&lt;p&gt;I follow this post up with a cat photo and explanation for each material. There's bronze and aluminum, leather and paper mache as well as various plastics and ceramics. The next step is to produce a digital model to try with different digital fabrication (3d printing, laser cutting layers, milling?...) processes.&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn:1"&gt;
&lt;p&gt;I got this tip on thinning the sealant with turps, years ago from the blog of a trans-gender engineer who was experimenting with cheap ways to make falsies. The blog was a fascinating mix of their work on the west coast of the US, their experiments with mould making and their trips to Las Vegas to test the latest version.&amp;#160;&lt;a class="footnote-backref" href="#fnref:1" rev="footnote" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</summary><category term="cats"></category><category term="materials"></category></entry><entry><title>The almost invisible kite</title><link href="http://www.elfnor.com/the-almost-invisible-kite.html" rel="alternate"></link><updated>2014-01-31T22:00:00+13:00</updated><author><name>elfnor</name></author><id>tag:www.elfnor.com,2014-01-31:the-almost-invisible-kite.html</id><summary type="html">&lt;p&gt;&lt;img alt="parasled" class="floatleft" src="http://www.elfnor.com/images/parasled.jpg" /&gt;&lt;/p&gt;
&lt;p&gt;Polythene sheeting, the type you buy at a garden shop that's about 125 Î¼m thick, is great for kite making. It comes in black and clear, the black is boring but the clear can be a bit hard to photograph against the sky.&lt;/p&gt;
&lt;p&gt;This kite is a cross between a sled and a para foil. I based it on plans found &lt;a href="http://www.kiteplans.org/pln_1074/"&gt;here&lt;/a&gt;. The instructions are in French but fairly easy to follow with the help of a dictionary or google translate if you don't read French.&lt;/p&gt;
&lt;p&gt;I combined the pattern for the Dos (back) and the tubes into one piece. Draw them up directly onto the polythene with a felt pen. If you're likely to make more than one it might be worth making a paper pattern. Draw the seam lines onto the sheet. Then cut the two pieces out of the polythene and sew them together with four lines of machine stitching.&lt;/p&gt;
&lt;p&gt;The polythene is pretty slippery on the sewing machine. Use a long stitch length and keep one hand behind the needle and one in front feeding the material through.&lt;/p&gt;
&lt;p&gt;I reinforced the front edge with some left over end lengths of line trimmer line. This is nylon line about 2.5 mm in diameter used in line trimmer for cutting weeds. Pick some up at the garden shop when you get the polythene if you haven' got any sitting about.  I stuck the line to the front edges with squares of duct tape. These didn't hold all that well so I stapled through each square to hold it in place.&lt;/p&gt;
&lt;p&gt;You'll also need a drogue, mine is a truncated cone, about 400 mm long, top circumference 500 mm, bottom circumference 300 mm. Sew two sections together and add line trimmer line along the leading edge as for the main kite.&lt;/p&gt;
&lt;p&gt;That's it. No spars, or dowels. It flies fairly well in most winds. I intend to use it to do some kite photography. Maybe with some first person view camera gear.&lt;/p&gt;</summary><category term="kites"></category></entry></feed>