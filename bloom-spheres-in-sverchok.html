<!doctype html>
<html lang="">	
<head>
	<meta charset="utf-8"/>
	<title>Bloom Spheres in Sverchok - Look Think Make</title>	
	<meta name="author" content="elfnor">
	

	<meta name="description" content="These videos by John Edmark of what he calls bloom spheres inspired me to try something similar in Sverchok. Edmark has designed and 3D printed forms that when spun under a strobe light appear to move and twist. Its possible to produce computer animations that work in the same way ...">


	<link rel="top" href="#" /><link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro' rel='stylesheet' type='text/css'></link>
	<link href='http://fonts.googleapis.com/css?family=Bitter' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Rock+Salt' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="http://www.elfnor.com/theme/css/main.css" type="text/css" />
		

    <link href="http://www.elfnor.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Look Think Make Atom Feed" />
</head>
	
<body>

    <div class="container">
	  
	  <header role="banner">
	    <div class="feeds">
	        <a href="http://www.elfnor.com/feeds/all.atom.xml" rel="alternate"><img src="/theme/images/icons/feed-32px.png" alt="atom feed"/></a>
	    </div>
	      <nav class="pages">
			  <a href="http://www.elfnor.com/pages/about-me.html">About Me</a>
-			  <a href="http://www.elfnor.com/pages/galleries.html">Galleries</a>
	      </nav>
		<a href="http://www.elfnor.com" class="title">Look Think Make</a>
      </header>
	
	  <div class="wrapper">

		  <div role="main" class="content">
	<article class="full">
			
		<h1>Bloom Spheres in Sverchok</h1>
		
<div class="metadata">
  <time datetime="2015-09-09T22:00:00+12:00" pubdate>Wed 09 September 2015</time>
    <address class="vcard author">
      by <a class="url fn" href="http://www.elfnor.com/author/elfnor.html">elfnor</a>
    </address>
  in <a href="http://www.elfnor.com/category/think.html">think</a>
<p class="tags">tagged <a href="http://www.elfnor.com/tag/make.html">make</a>, <a href="http://www.elfnor.com/tag/think.html">think</a>, <a href="http://www.elfnor.com/tag/blender.html">blender</a>, <a href="http://www.elfnor.com/tag/sverchok.html">sverchok</a></p></div>		
		<p><img alt="bloom wobble still" src="/images/bloom_wobble.png" /></p>
<p>These <a href="http://www.instructables.com/id/Blooming-Zoetrope-Sculptures/">videos by John Edmark</a> of what he calls bloom spheres inspired me to try something similar in Sverchok. Edmark has designed and 3D printed forms that when spun under a strobe light appear to move and twist.</p>
<p>Its possible to produce computer animations that work in the same way. <a href="https://www.youtube.com/channel/UClifVGXznefMacC29olhX7g">Mangakid</a> has already made some animations in Blender based on Edmark's work. Python code snippets for mangakid's animations can be found on this <a href="http://blender.stackexchange.com/questions/1371/organic-yet-accurate-modeling-with-the-golden-spiral/26800#26800">stackoverflow question and answer</a>.</p>
<p>The first stage to work on bloom spheres in Sverchok was to write a scripted node to produce the basic mesh structure that underlies the blooms. Edmark describes this as:</p>
<blockquote>
<p>First a set of points are placed, one-at-a-time, in a cylindrical arrangement. Each point is placed 137.5ยบ  around the cylinder's axis from the previous point and also raised a bit...</p>
<p>The next step is to project each point onto the sphere's surface by projecting the point toward the center point of the sphere...</p>
<p>The points are connected with lines to form a quadrilateral mesh.</p>
</blockquote>
<p>This is best worked out in spherical coordinates.</p>
<p>The golden angle <span class="math">\(g\)</span> is given by
</p>
<div class="math">$$
\begin{align*}
g=\pi (3-\sqrt{5}) &amp;= 2.399963... \textrm{ radians}\\ 
 &amp;= 137.507...^{\circ}
\end{align*}
$$</div>
<p>The radius of the sphere is <span class="math">\(r_0\)</span> and <span class="math">\(z_h\)</span> is the increment by which the "point is raised a bit". Then for <span class="math">\(i = 0, 1 ... n\)</span> the points on the bloom sphere are given by:</p>
<div class="math">$$
\begin{align*}
\theta (i) &amp;= \frac{i}{g}\\
\phi (i) &amp;= \tan^{-1} \frac{r_0}{iz_h}\\
r(i) &amp;= r_0
\end{align*}
$$</div>
<p>I've coded this up into a scripted node. To use the bloom sphere node in Blender first install the <a href="http://nikitron.cc.ua/sverchok_en.html">Sverchok</a> addon. Download the bloom sphere code from <a href="https://github.com/elfnor/bloom_sphere">github</a>. Then load the python file as a text blocks into a blend file. Add a <code>Scripted Node</code> to a Sverchok node tree. On the node select the <code>bloom_sphere.py</code> code from the lower drop down. Then click the plugin icon to the right of this field. The node should turn blue with some inputs and outputs. Wire the <code>Verts</code> and <code>Faces</code> outputs to a <code>Viewer Draw</code> node and you should see some geometry.</p>
<p>It is also possible to use the <code>XYZ function surface</code> that is part of the <code>Extra Objects</code> addon for Blender to generate the mesh vertices. I found it much harder to get the addon to join then up to form the correct quadrilateral mesh. It was much easier to do this in my Sverchok scripted node.</p>
<p>The <code>Frame Info</code> node can be easily used to rotate the bloom sphere 137.5&deg; every frame. Set the end frame to 145 for a continuous loop animation.</p>
<p><img alt="node diagram scripted node" src="/images/bloom_sphere_nodes.png" /></p>
<p><img alt="animation" src="/images/bloom_sphere.gif" /></p>
<p>The same node diagram can also be used to animate any of John Edmark's stl files that he has made available <a href="https://www.dropbox.com/sh/nsinei7jlu0z3wk/AADsN9wI7IOIF6VOnREx-Tt6a?dl=0">here</a> under a Creative Commons BY NC SA license. Just import the stl into Blender and replace the <code>Scripted Node</code> with a <code>Object Scene</code> node.</p>
<p>Alternatively to spin a mesh outside Sverchok, make a key frame animation where the first frame has no rotation and the End frame has 137.5&deg; * (number of frames - 1) rotation about the z-axis. </p>
<p>For example: </p>
<ul>
<li>Select the object to be rotated</li>
<li>Set the End Frame to 145</li>
<li>Change the Active Keying Set to "Rotation"</li>
<li>Insert a Key Frame on the first frame</li>
<li>Move to the last frame</li>
<li>Set the rotation of the object around the z-axis to 19800 degrees (144 * 137.5&deg; = 19800)</li>
<li>Insert a Key Frame on this frame</li>
<li>Set the Current Frame back to 1</li>
<li>Open up a Graph Editor view</li>
<li>Change the Interpolation Mode for the animation curve to linear. Using the menu: Key &gt; Interpolation Mode &gt; Linear or using the keyboard <code>T L</code>.</li>
<li>Check that stepping along one frame changes the Rotation Z angle by 137.5&deg;</li>
</ul>
<p>This will give a seamless 6 second (145 frames/ 24 frames per second ~= 6 seconds) animation. It is seamless because 19800 is a whole multiple of 360 (360&deg; * 55 = 19800&deg;).</p>
<p>Note: Any rotation angle where</p>
<div class="math">$$
g_{n,m} = ng - m2\pi
$$</div>
<p>where <span class="math">\(n= 1,2,..\)</span> anf <span class="math">\(m\)</span> is an integer chosen to map the angle back to the interval <span class="math">\(-\pi\)</span> to <span class="math">\(\pi\)</span> will also work.  For example rotating any of 137.5&deg;, -85&deg;, 52.5&deg;, 170&deg;, -32.5&deg;, 105&deg;, -117.5&deg;, or 20&deg; per frame will work but for each angle the animation will appear to have a different speed. </p>
<p>Now comes the fun part, editing the mesh to produce interesting animations. John Edmark describes:</p>
<blockquote>
<p>Each of the quadrilaterals is populated with an appendage ...</p>
</blockquote>
<p>We could do this following  my <a href="http://www.elfnor.com/simple-sverchok-01-centers-polygons.html"><code>Centers Polygon</code> example</a> but I'll use the <code>Adaptive Polygons</code> node to show another way for a different look.</p>
<p><img alt="node diagram adaptive polygons" src="/images/bloom_sphere_adaptive_polygon_nodes.png" /></p>
<p>I've removed the nodes used to achieve the rotation to simplify the above node diagram.</p>
<p><img alt="animation adaptive polygons" src="/images/bloom_sphere_ap.gif" /></p>
<p>John Edmark then goes on to describe:</p>
<blockquote>
<p>In order to make the appendages appear to move back and forth when animated, their tips are sequentially distorted side-to-side (in a sinusoidal motion) as they are placed.</p>
</blockquote>
<p>The simplest way of doing something similar to this is to move each vertex side to side before the <code>Adaptive Polygons</code> node. Adding "Side to side" motion is most easily thought of in spherical coordinates. If we vary the "phi" polar coordinate of a point it will move side to side.</p>
<p>Sverchok now has nodes to change the x, y, z coordinates of a vertex into polar coordinates and change them back again.  Here we apply a sinusoidal offset to each vertex. The frequency of the sinusoid is varied by changing the <code>stop</code> value of the <code>Float Series</code> node. A multiple (or fraction) of <span class="math">\(\pi\)</span> is sensible. A <code>Float</code> entry node is used to change the amplitude of the sinusoid. </p>
<p><img alt="node bloom sphere vertex wobble" src="/images/wobble_vertex_node_tree.png" /></p>
<p><img alt="animation" src="/images/wobble_vertex.gif" /></p>
<p>With a bit more thought (and a few more nodes!) we can actually wobble just the ends of our <s>appendages</s>  adaptive polygons. </p>
<p>First we need to separate out the end vertices with a <code>List Mask (out)</code> node. For the mask we use the length of each vertex (with a <code>Vector Math</code> node) to select those vertices not on the surface of the bloom sphere. It takes a little messing around with <code>List Length</code> nodes to get the range of numbers to use as the angle input for the sinusoid. This multi-level list needs to have the same angle value for all the points at the end of single spike and then increment for the next spike.</p>
<p>The two sets of vertices (the end vertices with the sinusoidal wobble and the original vertices on the sphere) are put back together with a <code>List Mask Join (in)</code> node using the same mask we used for separating them. </p>
<p><a href="/images/sc_bloom_sphere_node_11_nodetree_for_post.blend_large_02.png"><img alt="node appendage end wobble" src="/images/sc_bloom_sphere_node_11_nodetree_for_post.blend_small.png" title="Click for larger version" /></a></p>
<p>to get an animation like this:</p>
<p><img alt="bloom wobble gif" src="/images/wobble_color.gif" /></p>
<hr />
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }
    
    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript'; 
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>	

	</article>

	<div class="comments">
	<h2>Comments !</h2>
	    <div id="disqus_thread"></div>
	    <script type="text/javascript">
	       var disqus_identifier = "bloom-spheres-in-sverchok.html";
	       (function() {
	       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	       dsq.src = 'http://lookthinkmake.disqus.com/embed.js';
	       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	      })();
	    </script>
	</div>

		  </div>	
		  
		  <div class="sidebar">

	        <nav>
		  <h2>Recent Posts</h2>
			<ul class="archive">
	
			      <li>
<a href="http://www.elfnor.com/larger-hyperbolic-tilings-in-3d-using-processing.html" rel="bookmark" title="Permalink to Larger Hyperbolic Tilings in 3D using Processing">Larger Hyperbolic Tilings in 3D using Processing</a>
  <time datetime="2015-11-27T22:00:00+13:00" pubdate>Fri 27 November 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/processing.html">processing  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/symmetry-tile-painting-in-blender.html" rel="bookmark" title="Permalink to Symmetry Tile Painting in Blender">Symmetry Tile Painting in Blender</a>
  <time datetime="2015-11-21T22:00:00+13:00" pubdate>Sat 21 November 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/symmetrytile.html">symmetrytile  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/painting-in-the-hyperbolic-plane.html" rel="bookmark" title="Permalink to Painting in the Hyperbolic Plane">Painting in the Hyperbolic Plane</a>
  <time datetime="2015-11-14T22:00:00+13:00" pubdate>Sat 14 November 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/sverchok.html">sverchok  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/hyperbolic-tiling-in-3d.html" rel="bookmark" title="Permalink to Hyperbolic Tiling in 3D">Hyperbolic Tiling in 3D</a>
  <time datetime="2015-11-06T22:00:00+13:00" pubdate>Fri 06 November 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/sverchok.html">sverchok  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/shaders-for-sverchok-04-vertex-colors-update.html" rel="bookmark" title="Permalink to Shaders for Sverchok 04 - Vertex Colors Update">Shaders for Sverchok 04 - Vertex Colors Update</a>
  <time datetime="2015-10-02T22:00:00+13:00" pubdate>Fri 02 October 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/sverchok.html">sverchok  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/blender-linked-stars.html" rel="bookmark" title="Permalink to Blender Linked Stars">Blender Linked Stars</a>
  <time datetime="2015-09-27T22:00:00+13:00" pubdate>Sun 27 September 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a></p></a>      			      </li>
		
	
			      <li>
<a href="http://www.elfnor.com/bloom-spheres-in-sverchok.html" rel="bookmark" title="Permalink to Bloom Spheres in Sverchok">Bloom Spheres in Sverchok</a>
  <time datetime="2015-09-09T22:00:00+12:00" pubdate>Wed 09 September 2015</time>
<p class="tags">tags: <a href="http://www.elfnor.com/tag/make.html">make  </a><a href="http://www.elfnor.com/tag/think.html">think  </a><a href="http://www.elfnor.com/tag/blender.html">blender  </a><a href="http://www.elfnor.com/tag/sverchok.html">sverchok  </a></p></a>      			      </li>
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
	
                        </u1>
		
		</nav>

	          <h2>Categories</h2>
	          <ul class = "social">
		      <li> <a href="http://www.elfnor.com/archives.html">everything </a></li>	
	              <li ><a href="http://www.elfnor.com/category/look.html">look</a></li>
	              <li ><a href="http://www.elfnor.com/category/make.html">make</a></li>
	              <li class="active"><a href="http://www.elfnor.com/category/think.html">think</a></li>
	          </ul>
	        

	          <aside>
	          <h2>Elsewhere</h2>
			    <ul class="social">
				  <li><a href="http://elfnor.deviantart.com">on deviant art</a><i></i></li>
				  <li><a href="http://www.thingiverse.com/elfnor">on thingiverse</a><i></i></li>
				  <li><a href="https://github.com/elfnor">on github</a><i></i></li>
			    </ul>
			  </aside>
                
                <h2>Tags</h2>
	
                        <ul class="tagcloud">
                            <li class="tag-2"><a href="http://www.elfnor.com/tag/structuresynth.html">structuresynth</a></li>
                            <li class="tag-2"><a href="http://www.elfnor.com/tag/symmetrytile.html">symmetrytile</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/ebook.html">ebook</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/cats.html">cats</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/pelican.html">pelican</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/nonsense.html">nonsense</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/3d-printing.html">3D Printing</a></li>
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/make.html">make</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/markdown.html">markdown</a></li>
                            <li class="tag-2"><a href="http://www.elfnor.com/tag/reading.html">reading</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/materials.html">materials</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/micropython.html">micropython</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/copy2.html">copy2</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/python.html">python</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/webalbum.html">webalbum</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/processing.html">processing</a></li>
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/blender.html">blender</a></li>
                            <li class="tag-3"><a href="http://www.elfnor.com/tag/geocaching.html">geocaching</a></li>
                            <li class="tag-4"><a href="http://www.elfnor.com/tag/kites.html">kites</a></li>
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/sverchok.html">sverchok</a></li>
                            <li class="tag-1"><a href="http://www.elfnor.com/tag/think.html">think</a></li>
                        </ul>
                      
		
		  </div>

	  </div>

      <footer>
		<p role="contentinfo">
		  ยฉ 2013 elfnor - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-simplegrey"> pelican-simplegrey</a>, modified.
    	</p>

	  </footer>	

	</div>
<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=9900594; 
var sc_invisible=1; 
var sc_security="efb2c43c"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="free hit
counter" href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="http://c.statcounter.com/9900594/0/efb2c43c/1/"
alt="free hit counter"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
</body>
</html>